<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2017-09-25 Mon 02:41 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>core</title>
<meta name="generator" content="Org-mode" />
<meta name="author" content="xieyuheng" />
<link rel="stylesheet" type="text/css" href="css/org-page.css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">core</h1>
<div id="table-of-contents">
<h2>overview</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org8fbb176"><span class="done _todo_stack_">[todo-stack]</span> </a>
<ul>
<li><a href="#org2c05599">use sub module for EOPL</a></li>
<li><a href="#orge526eda">EOPL</a></li>
<li><a href="#org591eb3">process calculi</a>
<ul>
<li><a href="#orgc590850">CSP</a></li>
<li><a href="#orga7dd7d3">actor</a></li>
</ul>
</li>
<li><a href="#orgfef2ec7">monad</a></li>
<li><a href="#org951f7c8">from minikanren</a></li>
<li><a href="#org5d91746">sexp syntax for org</a></li>
<li><a href="#org3a6682f">sexp syntax for html</a></li>
<li><a href="#org40bd31b">sexp syntax for c</a></li>
</ul>
</li>
<li><a href="#org9225cb4"><span class="todo _note_">[note]</span> </a>
<ul>
<li><a href="#org36de7ca">(data)</a></li>
</ul>
</li>
<li><a href="#orgc6a7a1f">flag</a></li>
<li><a href="#org65d95">&lt;int&gt;</a>
<ul>
<li><a href="#org869c68e">even &amp; odd</a></li>
</ul>
</li>
<li><a href="#org12afbf4">&lt;jo&gt;</a>
<ul>
<li><a href="#orgd18563b">jo-append</a></li>
<li><a href="#org78310f">tag-jo-&gt;jo</a></li>
<li><a href="#org58498e6">jo-&gt;tag-jo</a></li>
</ul>
</li>
<li><a href="#org22b3e7b">array</a>
<ul>
<li><a href="#org3fd37b9">array-eqv?</a></li>
</ul>
</li>
<li><a href="#org336ff05">list</a>
<ul>
<li><a href="#org92d75f3">&lt;null&gt; &amp; &lt;cons&gt;</a></li>
<li><a href="#orgbeb1e59">list?</a></li>
<li><a href="#orga71f5d3">array-&gt;list</a></li>
<li><a href="#orgc368ea7">list-spread</a></li>
<li><a href="#org7d52eb9">list-length</a></li>
<li><a href="#org4b6415b">list-any?</a></li>
<li><a href="#orgdf32c9f">list-every?</a></li>
<li><a href="#orgf6623e8">list-append</a></li>
<li><a href="#orgdb8a269">tail-cons</a></li>
<li><a href="#orgd06e719">list-left</a></li>
<li><a href="#orgf07299b">list-right</a></li>
<li><a href="#org8e23769">list-split</a></li>
<li><a href="#org4ea1b62">list-map</a></li>
<li><a href="#org57f682">list-for-each</a></li>
<li><a href="#org54a7e4a">list-filter</a></li>
<li><a href="#org7bc03e9">list-reverse</a></li>
<li><a href="#orgfde5eec">list-eqv?</a></li>
</ul>
</li>
<li><a href="#orgee4cc3b">sexp</a>
<ul>
<li><a href="#org121ef87"><span class="todo _note_">[note]</span> sexp</a></li>
<li><a href="#orgff9b2e8">read-sexp</a></li>
<li><a href="#orgc37e3bf">sexp-write</a></li>
</ul>
</li>
<li><a href="#orgc7a3a28">repl</a>
<ul>
<li><a href="#org7d12570">repl</a></li>
<li><a href="#org7b3e329">sexp-eval</a></li>
<li><a href="#orgfe2c27f">jo-eval</a></li>
</ul>
</li>
<li><a href="#org180d3fd">compiler</a>
<ul>
<li><a href="#org3128638">&lt;macro&gt;</a></li>
<li><a href="#orgbb1168d">(+macro)</a></li>
<li><a href="#orgc2c18b7">body-compile-jojo</a></li>
<li><a href="#org63ef043">sexp-compile-jojo</a></li>
<li><a href="#org952a641">sexp-list-compile</a></li>
<li><a href="#orgc7d30b3">macro-expend</a></li>
<li><a href="#org2a7fc42">macro-compile</a></li>
<li><a href="#orgce7eb7a">sexp-compile</a></li>
<li><a href="#orgdd33bf8">body-compile</a></li>
<li><a href="#org6590f10">jo-compile</a></li>
<li><a href="#org7030644">body-run</a></li>
<li><a href="#orgb8e4bc6">sexp-run</a></li>
</ul>
</li>
<li><a href="#org8705632">basic syntax</a>
<ul>
<li><a href="#org51b7e45">(quote)</a></li>
<li><a href="#org650db9b">(partquote)</a></li>
<li><a href="#org75822c5">(if)</a></li>
<li><a href="#orgf81ad2a">(tail-if)</a></li>
<li><a href="#org195cc3d">(clo)</a></li>
<li><a href="#org670bc9">(cond)</a></li>
<li><a href="#org375708d">(-&gt;)</a></li>
<li><a href="#org4ccdbba">jo-list-compile-cells</a></li>
<li><a href="#org89c333e">(+data)</a></li>
<li><a href="#orgf34d9df">(+gene)</a></li>
<li><a href="#org10cf0bc">(+disp)</a></li>
</ul>
</li>
<li><a href="#orgc03ed11">reboot basic syntax &#x2013; the order matters</a>
<ul>
<li><a href="#orga7796f">re-define (+jojo)</a></li>
<li><a href="#org60a5a9a">run repl-over-the-repl-in-c</a></li>
<li><a href="#org5c11148">re-define new keywords</a></li>
</ul>
</li>
<li><a href="#orge0151ad">more syntax</a>
<ul>
<li><a href="#orgc3f0529">(array)</a></li>
<li><a href="#org64d2959">(list)</a></li>
<li><a href="#org7b3bc0b">(assert) &amp; (assert!)</a></li>
<li><a href="#orgeaac428">(test)</a></li>
<li><a href="#org954aafc">(let-bind) &#x2013; moand interface</a></li>
<li><a href="#org586e5b2">(case)</a></li>
<li><a href="#org3d6337a">(+var)</a></li>
<li><a href="#org3eba81a">(set)</a></li>
<li><a href="#org18adfcc">(get)</a></li>
<li><a href="#org85cae79">(+atom)</a></li>
</ul>
</li>
<li><a href="#orgbcd30ad">monad</a>
<ul>
<li><a href="#org74a91ff"><span class="todo _note_">[note]</span> bind and compose can implement each ohter</a></li>
<li><a href="#org52cf45e">maybe monad</a></li>
<li><a href="#org2c75974"><span class="todo _gt__lt_">&gt;&lt;</span> list monad</a></li>
</ul>
</li>
<li><a href="#org41124b5">pair</a>
<ul>
<li><a href="#org9ad1409">&lt;pair&gt;</a></li>
</ul>
</li>
<li><a href="#orgaa06941">combinator</a>
<ul>
<li><a href="#orge77887">times</a></li>
</ul>
</li>
<li><a href="#orgd5e41b5">w &#x2013; write &#x2013; gene</a>
<ul>
<li><a href="#orgbde78e1">w</a></li>
<li><a href="#org7068e01">list-write</a></li>
<li><a href="#orgb7dbab5">array-write</a></li>
<li><a href="#org4bf6a97">pair-write</a></li>
<li><a href="#org216abcb">nl</a></li>
</ul>
</li>
<li><a href="#orgfef913e">equal? &#x2013; gene</a>
<ul>
<li><a href="#org894a5a4">equal?</a></li>
</ul>
</li>
<li><a href="#org82634a5">more list</a>
<ul>
<li><a href="#org8a19bfc">list-foldr</a></li>
<li><a href="#orgc352e5d">list-foldl</a></li>
<li><a href="#orgbeee8ae">list-member?</a></li>
</ul>
</li>
<li><a href="#org9116018">table</a>
<ul>
<li><a href="#orgaa3d418">&lt;null-table&gt; &amp; &lt;cons-table&gt;</a></li>
<li><a href="#org4dce8aa">table?</a></li>
<li><a href="#org3515843">list-&gt;table</a></li>
<li><a href="#orgcde495e">table</a></li>
<li><a href="#org2cb918c">table-write</a></li>
<li><a href="#orgccb3432">table-find</a></li>
<li><a href="#org156625">table-contain?</a></li>
<li><a href="#org7b4cdb4">table-merge</a></li>
<li><a href="#org7f2bc5c">table-equal?</a></li>
<li><a href="#orgc2a625f">table-key-filter</a></li>
<li><a href="#orgd19fc12">table-key-map</a></li>
</ul>
</li>
<li><a href="#org89a4504">byte</a>
<ul>
<li><a href="#orgc31b47f">(byte)</a></li>
</ul>
</li>
<li><a href="#org6a88bd">system</a>
<ul>
<li><a href="#orgab0afea">cmd-list</a></li>
<li><a href="#org650712b">dash-prefixed-string?</a></li>
<li><a href="#orgd2557b1">usr-jojo-dir</a></li>
<li><a href="#org4ea733c">sys-jojo-dir</a></li>
</ul>
</li>
<li><a href="#orgf2c17d0">&lt;lib&gt;</a>
<ul>
<li><a href="#orgd57695c">lib-load</a></li>
</ul>
</li>
<li><a href="#org9dec5b3">&lt;file&gt;</a>
<ul>
<li><a href="#orgb7db018">maybe-drop-shabang</a></li>
<li><a href="#org3fe6ba2">input-stack-read-sexp-list</a></li>
<li><a href="#orgd41e867">read-sexp-list-to-the-end</a></li>
<li><a href="#org14be9ce">absolute-path?</a></li>
<li><a href="#org2e1352e">path-&gt;reading-path</a></li>
<li><a href="#org4d35d16">path-readable?</a></li>
<li><a href="#org50db635">path-load</a></li>
</ul>
</li>
<li><a href="#orgf19a8a0">module</a>
<ul>
<li><a href="#orgc1ee416"><span class="todo _note_">[note]</span> module system</a></li>
<li><a href="#orgaed31b8">(+module)</a></li>
<li><a href="#orgdf6513d">expend-include</a></li>
<li><a href="#org7b6ea59">path-list-read-sexp-list</a></li>
<li><a href="#org1d447ee">path-read-sexp-list</a></li>
<li><a href="#org2f0342a">list-car-filter</a></li>
<li><a href="#org3d25727">module/generate-define-table-list</a>
<ul>
<li><a href="#orgc1adcad">module/generate-define-table-list</a></li>
<li><a href="#org9654163">module/plus-filter</a></li>
<li><a href="#orgcd4afba">module/name-list-&gt;table</a></li>
<li><a href="#org8c30c6">module/generate-jojo-table</a></li>
<li><a href="#org68a8452">module/generate-gene-table</a></li>
<li><a href="#orge7ff16a">module/generate-disp-table</a></li>
<li><a href="#orge09794a">module/generate-var-table</a></li>
<li><a href="#orga4d0671">module/tag-list-&gt;table</a></li>
<li><a href="#org488f2b0">module/tag-list-&gt;predicate-table</a></li>
<li><a href="#orgc848bad">module/tag-list-&gt;constructor-table</a></li>
<li><a href="#org523e2fd">module/generate-atom-table</a></li>
<li><a href="#orgdd41dc7">module/generate-data-table</a></li>
</ul>
</li>
<li><a href="#org9aa910a">module/generate-export-table</a></li>
<li><a href="#orgde5fe08">module/export-check</a></li>
<li><a href="#orgad77ec6">module/collect-import-table-list</a></li>
<li><a href="#org79b1629">module/import-one</a></li>
<li><a href="#org5bd6b7d">sexp-for-module?</a></li>
<li><a href="#orgbc44fa2">sexp-table-substitute</a></li>
<li><a href="#org9438cca">module-loaded?</a></li>
<li><a href="#org5eedcfc">module-find-path</a></li>
<li><a href="#orgbd85875">module-load</a></li>
<li><a href="#org209327">(run)</a></li>
<li><a href="#orgd6a558d"><span class="todo _note_">[note]</span> table processing in module system</a></li>
<li><a href="#org24389ea">import-only</a></li>
<li><a href="#org559fcd4">import-except</a></li>
<li><a href="#org44857c3">import-prefix</a></li>
<li><a href="#org5f875c8">import-rename</a></li>
</ul>
</li>
<li><a href="#orgccb4807">the-story-begin</a>
<ul>
<li><a href="#org268a063">welcome-to-jojo</a></li>
<li><a href="#org33b63f5">the-story-begin</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org8fbb176" class="outline-2">
<h2 id="org8fbb176"><span class="done _todo_stack_">[todo-stack]</span> </h2>
<div class="outline-text-2" id="text-org8fbb176">
</div><div id="outline-container-org2c05599" class="outline-3">
<h3 id="org2c05599">use sub module for EOPL</h3>
<div class="outline-text-3" id="text-org2c05599">
<ul class="org-ul">
<li><p><p></p><p>org-page</p><p>org-index</p><p></p></p><p></p><p><p></p><p>generated pages are based on org-publish</p><p>and include information generated form org-index</p><p>to navigate a book</p><p></p></p></li></ul>
</div>
</div>

<div id="outline-container-orge526eda" class="outline-3">
<h3 id="orge526eda">EOPL</h3>
<div class="outline-text-3" id="text-orge526eda">
<ul class="org-ul">
<li><p><p></p><p>a version of EOPL</p><p>for function-compose-language</p><p></p></p><p></p><p><p></p><p>we can do this by implement EOPL and re-factor it.</p><p></p></p><p></p><p><p></p><p>with concurrency in mind</p><p></p></p><p></p><p><p></p><p>and with the question about lazy-ness in mind</p><p></p></p></li></ul>
</div>
</div>

<div id="outline-container-org591eb3" class="outline-3">
<h3 id="org591eb3">process calculi</h3>
<div class="outline-text-3" id="text-org591eb3">
</div><div id="outline-container-orgc590850" class="outline-4">
<h4 id="orgc590850">CSP</h4>
</div>

<div id="outline-container-orga7dd7d3" class="outline-4">
<h4 id="orga7dd7d3">actor</h4>
<div class="outline-text-4" id="text-orga7dd7d3">
<ul class="org-ul">
<li><p>station</p></li>
<li><p>process</p></li>
<li><p>receive message and send message</p></li>
<li><p>message across the net</p></li>
<li><p>[maybe] (# &#x2026;) for message</p></li></ul>
</div>
</div>
</div>

<div id="outline-container-orgfef2ec7" class="outline-3">
<h3 id="orgfef2ec7">monad</h3>
<div class="outline-text-3" id="text-orgfef2ec7">
<ul class="org-ul">
<li><p>generic function over monad</p><p><ul class="org-ul"></p><p><li><p>maybe we need a new language</p><p>with type checker and type class to do this</p></li></ul></p></li>

<li><p>list monad</p></li></ul>
</div>
</div>

<div id="outline-container-org951f7c8" class="outline-3">
<h3 id="org951f7c8">from minikanren</h3>
<div class="outline-text-3" id="text-org951f7c8">
<ul class="org-ul">
<li><p>logic programming module</p></li></ul>
</div>
</div>

<div id="outline-container-org5d91746" class="outline-3">
<h3 id="org5d91746">sexp syntax for org</h3>
<div class="outline-text-3" id="text-org5d91746">
<ul class="org-ul">
<li><p>use jojo to write tangle</p></li>
<li><p>parse org</p></li></ul>
</div>
</div>

<div id="outline-container-org3a6682f" class="outline-3">
<h3 id="org3a6682f">sexp syntax for html</h3>
</div>

<div id="outline-container-org40bd31b" class="outline-3">
<h3 id="org40bd31b">sexp syntax for c</h3>
</div>
</div>

<div id="outline-container-org9225cb4" class="outline-2">
<h2 id="org9225cb4"><span class="todo _note_">[note]</span> </h2>
<div class="outline-text-2" id="text-org9225cb4">
</div><div id="outline-container-org36de7ca" class="outline-3">
<h3 id="org36de7ca">(data)</h3>
<div class="outline-text-3" id="text-org36de7ca">
<ul class="org-ul">
<li><p>type-name is the same as constructor-name</p><p>thus I use (data) instead of (type)</p></li></ul>
</div>
</div>
</div>

<div id="outline-container-orgc6a7a1f" class="outline-2">
<h2 id="orgc6a7a1f">flag</h2>
<div class="outline-text-2" id="text-orgc6a7a1f">
<div class="org-src-container">

<pre class="src src-jojo">core-flag-on
test-flag-on
repl-flag-off
</pre>
</div>
</div>
</div>

<div id="outline-container-org65d95" class="outline-2">
<h2 id="org65d95">&lt;int&gt;</h2>
<div class="outline-text-2" id="text-org65d95">
</div><div id="outline-container-org869c68e" class="outline-3">
<h3 id="org869c68e">even &amp; odd</h3>
<div class="outline-text-3" id="text-org869c68e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> even? <span style="color: #ae81ff;">2</span> mod <span style="color: #ae81ff;">0</span> eq?<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> odd? even? not<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org12afbf4" class="outline-2">
<h2 id="org12afbf4">&lt;jo&gt;</h2>
<div class="outline-text-2" id="text-org12afbf4">
</div><div id="outline-container-orgd18563b" class="outline-3">
<h3 id="orgd18563b">jo-append</h3>
<div class="outline-text-3" id="text-orgd18563b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> jo-append <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo1</span> <span style="color: #a6e22e;">:jo2</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:jo1</span> jo-&gt;string
  <span style="color: #a6e22e;">:jo2</span> jo-&gt;string
  string-append
  string-&gt;jo<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org78310f" class="outline-3">
<h3 id="org78310f">tag-jo-&gt;jo</h3>
<div class="outline-text-3" id="text-org78310f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tag-jo-&gt;jo <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tag-jo</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:tag-jo</span> tag-jo? not <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #e6db74;">"- tag-jo-&gt;jo fail"</span> string-write newline
      <span style="color: #e6db74;">"  jo is not tag jo : "</span> string-write <span style="color: #a6e22e;">:tag-jo</span> jo-write newline
      <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:tag-jo</span> jo-&gt;string <span style="color: #fd971f;">:tag-string!</span>
  <span style="color: #a6e22e;">:tag-string</span> string-length <span style="color: #fd971f;">:tag-string-length!</span>
  <span style="color: #a6e22e;">:tag-string</span> <span style="color: #ae81ff;">1</span> <span style="color: #a6e22e;">:tag-string-length</span> dec string-slice
  string-&gt;jo<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org58498e6" class="outline-3">
<h3 id="org58498e6">jo-&gt;tag-jo</h3>
<div class="outline-text-3" id="text-org58498e6">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> jo-&gt;tag-jo <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #66d9ef; font-weight: bold;">--</span> tag jo<span style="color: #696969;">)</span>
  '&lt; <span style="color: #a6e22e;">:jo</span> '&gt; jo-append jo-append<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org22b3e7b" class="outline-2">
<h2 id="org22b3e7b">array</h2>
<div class="outline-text-2" id="text-org22b3e7b">
</div><div id="outline-container-org3fd37b9" class="outline-3">
<h3 id="org3fd37b9">array-eqv?</h3>
<div class="outline-text-3" id="text-org3fd37b9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array-eqv? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:x</span> array-length
      <span style="color: #a6e22e;">:y</span> array-length
      eq? not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #ae81ff;">0</span> array-eqv?/loop<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array-eqv?/loop <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #a6e22e;">:index</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:index</span> <span style="color: #a6e22e;">:x</span> array-length gteq? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">true</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:index</span> array-ref
      <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:index</span> array-ref
      <span style="color: #a6e22e;">:pred</span> apply not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #a6e22e;">:index</span> inc <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org336ff05" class="outline-2">
<h2 id="org336ff05">list</h2>
<div class="outline-text-2" id="text-org336ff05">
</div><div id="outline-container-org92d75f3" class="outline-3">
<h3 id="org92d75f3">&lt;null&gt; &amp; &lt;cons&gt;</h3>
<div class="outline-text-3" id="text-org92d75f3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span><span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #ae81ff;">.car</span> .cdr<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cons
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup null? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> new <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> new <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"- cons fail"</span> string-write newline
  <span style="color: #e6db74;">"  cdr of cons must be &lt;null&gt; or &lt;cons&gt;"</span> string-write newline
  <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbeb1e59" class="outline-3">
<h3 id="orgbeb1e59">list?</h3>
<div class="outline-text-3" id="text-orgbeb1e59">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:x</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga71f5d3" class="outline-3">
<h3 id="orga71f5d3">array-&gt;list</h3>
<div class="outline-text-3" id="text-orga71f5d3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array-&gt;list <span style="color: #ae81ff;">0</span> right-of-array-&gt;list<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> right-of-array-&gt;list <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> <span style="color: #66d9ef; font-weight: bold;">--</span> list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:index</span> <span style="color: #a6e22e;">:array</span> array-length gteq?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> inc <span style="color: #66d9ef; font-weight: bold;">recur</span>
              <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> array-ref
              swap cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc368ea7" class="outline-3">
<h3 id="orgc368ea7">list-spread</h3>
<div class="outline-text-3" id="text-orgc368ea7">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-spread <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #797979;">[]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7d52eb9" class="outline-3">
<h3 id="org7d52eb9">list-length</h3>
<div class="outline-text-3" id="text-org7d52eb9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-length <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #ae81ff;">0</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> inc<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4b6415b" class="outline-3">
<h3 id="org4b6415b">list-any?</h3>
<div class="outline-text-3" id="text-org4b6415b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-any? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf32c9f" class="outline-3">
<h3 id="orgdf32c9f">list-every?</h3>
<div class="outline-text-3" id="text-orgdf32c9f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-every? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply not<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf6623e8" class="outline-3">
<h3 id="orgf6623e8">list-append</h3>
<div class="outline-text-3" id="text-orgf6623e8">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-append <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:left</span> <span style="color: #a6e22e;">:right</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:left</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:right</span><span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:left</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:right</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #a6e22e;">:left</span> <span style="color: #ae81ff;">.car</span> swap cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb8a269" class="outline-3">
<h3 id="orgdb8a269">tail-cons</h3>
<div class="outline-text-3" id="text-orgdb8a269">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-cons null cons list-append<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd06e719" class="outline-3">
<h3 id="orgd06e719">list-left</h3>
<div class="outline-text-3" id="text-orgd06e719">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-left <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> left<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span>
              <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
              cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf07299b" class="outline-3">
<h3 id="orgf07299b">list-right</h3>
<div class="outline-text-3" id="text-orgf07299b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-right <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> right<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8e23769" class="outline-3">
<h3 id="org8e23769">list-split</h3>
<div class="outline-text-3" id="text-org8e23769">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> left right<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null null<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null <span style="color: #a6e22e;">:list</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span>
              <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
              <span style="color: #fd971f;">:right!</span> cons <span style="color: #a6e22e;">:right</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ea1b62" class="outline-3">
<h3 id="org4ea1b62">list-map</h3>
<div class="outline-text-3" id="text-org4ea1b62">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">--</span> list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> null
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:fun</span> apply <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org57f682" class="outline-3">
<h3 id="org57f682">list-for-each</h3>
<div class="outline-text-3" id="text-org57f682">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-for-each <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #797979;">[]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:fun</span> apply <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org54a7e4a" class="outline-3">
<h3 id="org54a7e4a">list-filter</h3>
<div class="outline-text-3" id="text-org54a7e4a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-filter <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>null<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7bc03e9" class="outline-3">
<h3 id="org7bc03e9">list-reverse</h3>
<div class="outline-text-3" id="text-org7bc03e9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-reverse null swap list-reverse-swap-append<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-reverse-swap-append <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> left <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #797979;">[]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> swap cons <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfde5eec" class="outline-3">
<h3 id="orgfde5eec">list-eqv?</h3>
<div class="outline-text-3" id="text-orgfde5eec">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-eqv? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:l1</span> <span style="color: #a6e22e;">:l2</span> <span style="color: #a6e22e;">:eqv</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l1</span> null? <span style="color: #a6e22e;">:l2</span> null? and<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l1</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l2</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l1</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:l2</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:eqv</span> apply not<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l1</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:l2</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:eqv</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgee4cc3b" class="outline-2">
<h2 id="orgee4cc3b">sexp</h2>
<div class="outline-text-2" id="text-orgee4cc3b">
</div><div id="outline-container-org121ef87" class="outline-3">
<h3 id="org121ef87"><span class="todo _note_">[note]</span> sexp</h3>
<div class="outline-text-3" id="text-org121ef87">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> sexp
  = sexp list <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> or <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span>
  | <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span>
  | <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgff9b2e8" class="outline-3">
<h3 id="orgff9b2e8">read-sexp</h3>
<div class="outline-text-3" id="text-orgff9b2e8">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> read-sexp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  read-jo <span style="color: #fd971f;">:jo!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> round-bar eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>round-ket read-sexp-list-until-ket<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> square-bar eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>'begin square-ket read-sexp-list-until-ket cons<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> flower-bar eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>'clo flower-ket read-sexp-list-until-ket cons<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> doublequote eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>read-string<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> singlequote eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>'<span style="color: #66d9ef; font-weight: bold;">quote</span> null cons <span style="color: #66d9ef; font-weight: bold;">recur</span> tail-cons<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> backquote eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>'partquote null cons <span style="color: #66d9ef; font-weight: bold;">recur</span> tail-cons<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span> :jo<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> read-sexp-list-until-ket <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:ket</span> <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp list<span style="color: #696969;">)</span>
  read-jo <span style="color: #fd971f;">:jo!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:ket</span> eq?
      <span style="color: #66d9ef; font-weight: bold;">then</span> null
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:jo</span> jo-unread read-sexp<span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:ket</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #f92672; font-weight: bold;">,</span> cons<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc37e3bf" class="outline-3">
<h3 id="orgc37e3bf">sexp-write</h3>
<div class="outline-text-3" id="text-orgc37e3bf">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:sexp</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #797979;">[</span>'null jo-write<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span>round-bar jo-write <span style="color: #a6e22e;">:sexp</span> sexp-list-write
            round-ket jo-write<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #797979;">[</span>doublequote jo-write <span style="color: #a6e22e;">:sexp</span> string-write
              doublequote jo-write<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> jo-write<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-list-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> sexp list <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> sexp-write<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> sexp-write space
          <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc7a3a28" class="outline-2">
<h2 id="orgc7a3a28">repl</h2>
<div class="outline-text-2" id="text-orgc7a3a28">
</div><div id="outline-container-org7d12570" class="outline-3">
<h3 id="org7d12570">repl</h3>
<div class="outline-text-3" id="text-org7d12570">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> repl <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;input-stack&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  reading-stack-push
  repl/loop
  reading-stack-pop input-stack-free<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> repl/loop
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> has-jo? not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  read-sexp sexp-eval
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> repl-flag <span style="color: #66d9ef; font-weight: bold;">then</span> print-data-stack<span style="color: #696969;">)</span>
  <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> repl-over-the-repl-in-c
  repl/loop<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b3e329" class="outline-3">
<h3 id="org7b3e329">sexp-eval</h3>
<div class="outline-text-3" id="text-org7b3e329">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-eval <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:sexp</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span>   <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> sexp-compile-jojo apply<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span>   <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> sexp-compile-jojo apply<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> sexp-compile-jojo apply<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span>     <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> jo-eval<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe2c27f" class="outline-3">
<h3 id="orgfe2c27f">jo-eval</h3>
<div class="outline-text-3" id="text-orgfe2c27f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> jo-eval <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> int-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> sexp-compile-jojo apply<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> local-jo?
     <span style="color: #a6e22e;">:jo</span> set-local-jo? or
     <span style="color: #a6e22e;">:jo</span> dynamic-local-jo? or
     <span style="color: #a6e22e;">:jo</span> set-dynamic-local-jo? or
     <span style="color: #a6e22e;">:jo</span> field-jo? or
     <span style="color: #a6e22e;">:jo</span> set-field-jo? or<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #e6db74;">"- jo-eval can not handle : "</span> string-write
     <span style="color: #a6e22e;">:jo</span> jo-write newline<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> comma eq?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-bound? not<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #e6db74;">"- jo is not bound : "</span> string-write
     <span style="color: #a6e22e;">:jo</span> jo-write newline<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> sexp-compile-jojo apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org180d3fd" class="outline-2">
<h2 id="org180d3fd">compiler</h2>
<div class="outline-text-2" id="text-org180d3fd">
</div><div id="outline-container-org3128638" class="outline-3">
<h3 id="org3128638">&lt;macro&gt;</h3>
<div class="outline-text-3" id="text-org3128638">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;macro&gt;</span> <span style="color: #ae81ff;">.expend</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbb1168d" class="outline-3">
<h3 id="orgbb1168d">(+macro)</h3>
<div class="outline-text-3" id="text-orgbb1168d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +macro <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> sexp list <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> body-compile-jojo macro
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> name-bind<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2c18b7" class="outline-3">
<h3 id="orgc2c18b7">body-compile-jojo</h3>
<div class="outline-text-3" id="text-orgc2c18b7">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> body-compile-jojo <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;jojo&gt;</span><span style="color: #696969;">)</span>
  compiling-stack-tos <span style="color: #fd971f;">:address!</span>
  <span style="color: #a6e22e;">:body</span> body-compile
  emit-jojo-end
  <span style="color: #a6e22e;">:address</span> new-jojo
  compiling-stack-drop <span style="color: #a6e22e;">:address</span> compiling-stack-push<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org63ef043" class="outline-3">
<h3 id="org63ef043">sexp-compile-jojo</h3>
<div class="outline-text-3" id="text-org63ef043">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-compile-jojo null cons body-compile-jojo<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org952a641" class="outline-3">
<h3 id="org952a641">sexp-list-compile</h3>
<div class="outline-text-3" id="text-org952a641">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-list-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> sexp list <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> sexp-compile
     <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc7d30b3" class="outline-3">
<h3 id="orgc7d30b3">macro-expend</h3>
<div class="outline-text-3" id="text-orgc7d30b3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> macro-expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:sexp</span> cons? not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.car</span> jo-ref <span style="color: #fd971f;">:head!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:head</span> tag '<span style="color: #66d9ef; font-weight: bold;">&lt;macro&gt;</span> eq?
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:head</span> <span style="color: #ae81ff;">.expend</span> apply <span style="color: #66d9ef; font-weight: bold;">recur</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:sexp</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2a7fc42" class="outline-3">
<h3 id="org2a7fc42">macro-compile</h3>
<div class="outline-text-3" id="text-org2a7fc42">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> macro-compile <span style="color: #ae81ff;">.expend</span> apply sexp-compile<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgce7eb7a" class="outline-3">
<h3 id="orgce7eb7a">sexp-compile</h3>
<div class="outline-text-3" id="text-orgce7eb7a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:sexp</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span>   <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> emit-lit<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span>   <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> sexp-compile/cons<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> emit-lit<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span>     <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> jo-compile<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-compile/cons <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:sexp</span> macro-expend <span style="color: #fd971f;">:primitive-sexp!</span>
  <span style="color: #a6e22e;">:primitive-sexp</span> <span style="color: #ae81ff;">.cdr</span>
  <span style="color: #a6e22e;">:primitive-sexp</span> <span style="color: #ae81ff;">.car</span>
  jo-ref apply<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd33bf8" class="outline-3">
<h3 id="orgdd33bf8">body-compile</h3>
<div class="outline-text-3" id="text-orgdd33bf8">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-&gt;tail-sexp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> tail-sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> cons? not<span style="color: #797979;">]</span> <span style="color: #a6e22e;">:sexp</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.car</span> 'if eq?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>'tail-if <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.cdr</span> cons<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.car</span> 'begin eq?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span>'tail-begin <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.cdr</span> cons<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> :sexp<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> body-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> sexp list <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> null?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span>
     macro-expend
     sexp-&gt;tail-sexp
     sexp-compile<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> sexp-compile
     <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6590f10" class="outline-3">
<h3 id="org6590f10">jo-compile</h3>
<div class="outline-text-3" id="text-org6590f10">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> jo-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> int-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-&gt;int emit-lit<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> local-jo?<span style="color: #797979;">]</span>     <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-local<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> set-local-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-set-local<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> dynamic-local-jo?<span style="color: #797979;">]</span>     <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-dynamic-local<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> set-dynamic-local-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-set-dynamic-local<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> field-jo?<span style="color: #797979;">]</span>     <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-field<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> set-field-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit-set-field<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> comma eq?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:jo</span> jo-emit<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7030644" class="outline-3">
<h3 id="org7030644">body-run</h3>
<div class="outline-text-3" id="text-org7030644">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> body-run body-compile-jojo apply<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb8e4bc6" class="outline-3">
<h3 id="orgb8e4bc6">sexp-run</h3>
<div class="outline-text-3" id="text-orgb8e4bc6">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-run sexp-compile-jojo apply<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org8705632" class="outline-2">
<h2 id="org8705632">basic syntax</h2>
<div class="outline-text-2" id="text-org8705632">
</div><div id="outline-container-org51b7e45" class="outline-3">
<h3 id="org51b7e45">(quote)</h3>
<div class="outline-text-3" id="text-org51b7e45">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> <span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #B380A8;">{</span>emit-lit<span style="color: #B380A8;">}</span> list-for-each<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> <span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #B380A8;">{</span>sexp-quote-compile<span style="color: #B380A8;">}</span> list-for-each<span style="color: #696969;">)</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-quote-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:sexp</span> cons?
        <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:sexp</span> sexp-list-quote-compile
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:sexp</span> emit-lit<span style="color: #696969;">))</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-list-quote-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span>
      <span style="color: #797979;">[</span>null emit-lit<span style="color: #797979;">]</span>

      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> cons? not<span style="color: #797979;">]</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
       <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> emit-lit
       'swap jo-emit
       'cons jo-emit<span style="color: #797979;">]</span>

      <span style="color: #66d9ef; font-weight: bold;">else</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
       <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
       'swap jo-emit
       'cons jo-emit<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org650db9b" class="outline-3">
<h3 id="org650db9b">(partquote)</h3>
<div class="outline-text-3" id="text-org650db9b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> partquote <span style="color: #B380A8;">{</span>sexp-partquote-compile<span style="color: #B380A8;">}</span> list-for-each<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-partquote-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:sexp</span> cons?
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:sexp</span> sexp-list-partquote-compile
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:sexp</span> emit-lit<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> this function depends on <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-list-partquote-compile <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>null emit-lit<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> cons? not<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
     <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> emit-lit
     'swap jo-emit
     'cons jo-emit<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #ae81ff;">.car</span> '<span style="color: #ae81ff;">@</span> eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
     <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #ae81ff;">.cdr</span> list macro-compile
     'swap jo-emit
     'list-append jo-emit<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
     <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
     'swap jo-emit
     'cons jo-emit<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org75822c5" class="outline-3">
<h3 id="org75822c5">(if)</h3>
<div class="outline-text-3" id="text-org75822c5">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> if-else-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then-else</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:then-else</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:then</span> <span style="color: #a6e22e;">:else</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:question</span> sexp-list-compile
  emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
  <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> sexp-list-compile
  emit-jmp <span style="color: #fd971f;">:address-for-jmp!</span>
  <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here
  <span style="color: #a6e22e;">:else</span> <span style="color: #ae81ff;">.cdr</span> sexp-list-compile
  <span style="color: #a6e22e;">:address-for-jmp</span> set-offset-to-here<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:question</span> sexp-list-compile
  emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
  <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> sexp-list-compile
  <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> core-if <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-any?
     <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any? and<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> if-else-then<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> if-then<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"- (if) fail"</span> string-write newline
          <span style="color: #e6db74;">"  the body dose not has 'then"</span> string-write newline
          <span style="color: #e6db74;">"  body : "</span> string-write <span style="color: #a6e22e;">:body</span> sexp-list-write newline
          <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf81ad2a" class="outline-3">
<h3 id="orgf81ad2a">(tail-if)</h3>
<div class="outline-text-3" id="text-orgf81ad2a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if-else-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then-else</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:then-else</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:then</span> <span style="color: #a6e22e;">:else</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:question</span> sexp-list-compile
  emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
  <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit
  <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here
  <span style="color: #a6e22e;">:else</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:question</span> sexp-list-compile
  emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
  <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit
  <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-any?
     <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any? and<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> tail-if-else-then<span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> tail-if-then<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"- (tail-if) fail"</span> string-write newline
          <span style="color: #e6db74;">"  the body dose not has 'then"</span> string-write newline
          <span style="color: #e6db74;">"  body : "</span> string-write <span style="color: #a6e22e;">:body</span> sexp-list-write newline
          <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>


<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if-else-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then-else</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:then-else</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:then</span> <span style="color: #a6e22e;">:else</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:question</span> sexp-list-compile
    emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
    <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit
    emit-jmp <span style="color: #fd971f;">:address-for-jmp!</span>
    <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here
    <span style="color: #a6e22e;">:else</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit
    <span style="color: #a6e22e;">:address-for-jmp</span> set-offset-to-here<span style="color: #696969;">)</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-split <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:then</span><span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:question</span> sexp-list-compile
    emit-jz <span style="color: #fd971f;">:address-for-jz!</span>
    <span style="color: #a6e22e;">:then</span> <span style="color: #ae81ff;">.cdr</span> body-compile '<span style="color: #66d9ef; font-weight: bold;">end</span> jo-emit
    <span style="color: #a6e22e;">:address-for-jz</span> set-offset-to-here<span style="color: #696969;">)</span>

  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-if <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #B380A8;">}</span> list-any?
       <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any? and<span style="color: #797979;">]</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> tail-if-else-then<span style="color: #797979;">]</span>

      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">then</span> eq?<span style="color: #B380A8;">}</span> list-any?<span style="color: #797979;">]</span>
      <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> tail-if-then<span style="color: #797979;">]</span>

      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"- (tail-if) fail"</span> string-write newline
            <span style="color: #e6db74;">"  the body dose not has 'then"</span> string-write newline
            <span style="color: #e6db74;">"  body : "</span> string-write <span style="color: #a6e22e;">:body</span> sexp-list-write newline
            <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org195cc3d" class="outline-3">
<h3 id="org195cc3d">(clo)</h3>
<div class="outline-text-3" id="text-org195cc3d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> core-clo
  body-compile-jojo emit-lit
  'current-local-env jo-emit
  'closure jo-emit<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org670bc9" class="outline-3">
<h3 id="org670bc9">(cond)</h3>
<div class="outline-text-3" id="text-org670bc9">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cond/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> list-length <span style="color: #ae81ff;">2</span> eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> cond/expend-if-then
     '<span style="color: #66d9ef; font-weight: bold;">else</span> tail-cons
     'cond/miss-match-report tail-cons
     '<span style="color: #66d9ef; font-weight: bold;">debug</span> tail-cons<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> cond/expend-if-then
     '<span style="color: #66d9ef; font-weight: bold;">else</span> tail-cons
     <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> tail-cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cond/miss-match-report
  <span style="color: #e6db74;">"- runtime (cond) miss match"</span> string-write newline<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cond/expend-if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:answer</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
    `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:question</span> '<span style="color: #66d9ef; font-weight: bold;">else</span> eq?
                <span style="color: #66d9ef; font-weight: bold;">then</span> '<span style="color: #66d9ef; font-weight: bold;">true</span>
                <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:question</span><span style="color: #696969;">))</span>
         <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> :answer<span style="color: #696969;">))))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cond/expend-if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:question</span> <span style="color: #a6e22e;">:answer</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:question</span> '<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span>'if null cons
         '<span style="color: #66d9ef; font-weight: bold;">true</span> tail-cons
         '<span style="color: #66d9ef; font-weight: bold;">then</span> tail-cons
         <span style="color: #a6e22e;">:answer</span> tail-cons<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span>
        <span style="color: #797979;">[</span>'if null cons
         <span style="color: #a6e22e;">:question</span> tail-cons
         '<span style="color: #66d9ef; font-weight: bold;">then</span> tail-cons
         <span style="color: #a6e22e;">:answer</span> tail-cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org375708d" class="outline-3">
<h3 id="org375708d">(-&gt;)</h3>
<div class="outline-text-3" id="text-org375708d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> arrow/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">--</span> eq?<span style="color: #B380A8;">}</span> list-left
  <span style="color: #B380A8;">{</span>local-jo?<span style="color: #B380A8;">}</span> list-filter
  <span style="color: #B380A8;">{</span>local-jo-&gt;set-local-jo<span style="color: #B380A8;">}</span> list-map
  list-reverse
  'begin swap cons<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ccdbba" class="outline-3">
<h3 id="org4ccdbba">jo-list-compile-cells</h3>
<div class="outline-text-3" id="text-org4ccdbba">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> jo-list-compile-cells <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;address&gt;</span><span style="color: #696969;">)</span>
  compiling-stack-tos <span style="color: #fd971f;">:address!</span>
  <span style="color: #a6e22e;">:list</span> <span style="color: #B380A8;">{</span>jo-emit<span style="color: #B380A8;">}</span> list-for-each
  emit-zero
  <span style="color: #a6e22e;">:address</span> cells-copy <span style="color: #fd971f;">:new-address!</span>
  compiling-stack-drop <span style="color: #a6e22e;">:address</span> compiling-stack-push
  <span style="color: #a6e22e;">:new-address</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org89c333e" class="outline-3">
<h3 id="org89c333e">(+data)</h3>
<div class="outline-text-3" id="text-org89c333e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> plus-data <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> tag-jo? not <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #e6db74;">"- (+data) fail"</span> string-write newline
      <span style="color: #e6db74;">"  name must be of form &lt;...&gt;"</span> string-write newline
      <span style="color: #e6db74;">"  body : "</span> string-write <span style="color: #a6e22e;">:body</span> sexp-list-write newline
      <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>

  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span>
  <span style="color: #B380A8;">{</span>field-jo?<span style="color: #B380A8;">}</span> list-filter
  jo-list-compile-cells <span style="color: #fd971f;">:address!</span>

  <span style="color: #a6e22e;">:address</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> name-bind-data<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf34d9df" class="outline-3">
<h3 id="orgf34d9df">(+gene)</h3>
<div class="outline-text-3" id="text-orgf34d9df">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> plus-gene <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #fd971f;">:rest-body!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:arrow-sexp!</span>

  <span style="color: #a6e22e;">:arrow-sexp</span> <span style="color: #ae81ff;">.cdr</span>
  <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">--</span> eq?<span style="color: #B380A8;">}</span> list-left
  <span style="color: #B380A8;">{</span>local-jo?<span style="color: #B380A8;">}</span> list-filter
  list-length
  <span style="color: #a6e22e;">:name</span> name-bind-gene

  <span style="color: #a6e22e;">:rest-body</span> body-compile-jojo
  <span style="color: #a6e22e;">:name</span> name-bind-disp-default-to-jojo<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org10cf0bc" class="outline-3">
<h3 id="org10cf0bc">(+disp)</h3>
<div class="outline-text-3" id="text-org10cf0bc">
<ul class="org-ul">
<li><p>this syntax always use &lt;jojo&gt; as disp</p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> plus-disp <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #fd971f;">:rest-body!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:arrow-sexp!</span>

  <span style="color: #a6e22e;">:arrow-sexp</span> <span style="color: #ae81ff;">.cdr</span>
  <span style="color: #B380A8;">{</span>'<span style="color: #66d9ef; font-weight: bold;">--</span> eq?<span style="color: #B380A8;">}</span> list-left
  <span style="color: #B380A8;">{</span>tag-jo?<span style="color: #B380A8;">}</span> list-filter
  jo-list-compile-cells <span style="color: #fd971f;">:address-of-tags!</span>

  <span style="color: #a6e22e;">:rest-body</span> body-compile-jojo
  <span style="color: #a6e22e;">:address-of-tags</span>
  <span style="color: #a6e22e;">:name</span> name-bind-disp-to-jojo<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgc03ed11" class="outline-2">
<h2 id="orgc03ed11">reboot basic syntax &#x2013; the order matters</h2>
<div class="outline-text-2" id="text-orgc03ed11">
</div><div id="outline-container-orga7796f" class="outline-3">
<h3 id="orga7796f">re-define (+jojo)</h3>
<div class="outline-text-3" id="text-orga7796f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +jojo <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> sexp list <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> body-compile-jojo
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> name-bind<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org60a5a9a" class="outline-3">
<h3 id="org60a5a9a">run repl-over-the-repl-in-c</h3>
<div class="outline-text-3" id="text-org60a5a9a">
<div class="org-src-container">

<pre class="src src-jojo">repl-over-the-repl-in-c
</pre>
</div>
</div>
</div>

<div id="outline-container-org5c11148" class="outline-3">
<h3 id="org5c11148">re-define new keywords</h3>
<div class="outline-text-3" id="text-org5c11148">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> note drop<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> begin sexp-list-compile<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> tail-begin body-compile<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> if core-if<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> clo core-clo<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> cond cond/expend<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> arrow/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +data plus-data<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +gene plus-gene<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +disp plus-disp<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orge0151ad" class="outline-2">
<h2 id="orge0151ad">more syntax</h2>
<div class="outline-text-2" id="text-orge0151ad">
</div><div id="outline-container-orgc3f0529" class="outline-3">
<h3 id="orgc3f0529">(array)</h3>
<div class="outline-text-3" id="text-orgc3f0529">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> array array/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  'begin null cons
  'mark tail-cons
  <span style="color: #a6e22e;">:body</span> list-append
  'collect tail-cons<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org64d2959" class="outline-3">
<h3 id="org64d2959">(list)</h3>
<div class="outline-text-3" id="text-org64d2959">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> list list/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  'begin null cons
  'mark tail-cons
  <span style="color: #a6e22e;">:body</span> list-append
  'collect tail-cons
  'array-&gt;list tail-cons<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b3bc0b" class="outline-3">
<h3 id="org7b3bc0b">(assert) &amp; (assert!)</h3>
<div class="outline-text-3" id="text-org7b3bc0b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> assert assert/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> assert/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span> list-spread<span style="color: #696969;">)</span>
       <span style="color: #66d9ef; font-weight: bold;">then</span>
       <span style="color: #66d9ef; font-weight: bold;">else</span>
       <span style="color: #e6db74;">"- (assert) fail"</span> string-write newline
       <span style="color: #e6db74;">"  assertion : "</span> string-write
       <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span><span style="color: #696969;">))</span> sexp-list-write newline<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> <span style="color: #fd971f;">assert!</span> assert!/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> assert!/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span> list-spread<span style="color: #696969;">)</span>
       <span style="color: #66d9ef; font-weight: bold;">then</span>
       <span style="color: #66d9ef; font-weight: bold;">else</span>
       <span style="color: #e6db74;">"- (assert!) fail"</span> string-write newline
       <span style="color: #e6db74;">"  assertion : "</span> string-write
       <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span><span style="color: #696969;">))</span> sexp-list-write newline
       <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgeaac428" class="outline-3">
<h3 id="orgeaac428">(test)</h3>
<div class="outline-text-3" id="text-orgeaac428">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> test <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> test-flag <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:body</span> begin<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org954aafc" class="outline-3">
<h3 id="org954aafc">(let-bind) &#x2013; moand interface</h3>
<div class="outline-text-3" id="text-org954aafc">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> example
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">let-bind</span> bind-maybe
    <span style="color: #a6e22e;">:l</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.l</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.l</span> zip-tree<span style="color: #797979;">]</span>
    <span style="color: #a6e22e;">:r</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.r</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.r</span> zip-tree<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:r</span> node return-maybe<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">begin</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.l</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.l</span> tree-zip<span style="color: #797979;">]</span>
    <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:l!</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.r</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.r</span> zip-tree<span style="color: #797979;">]</span>
     <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:r!</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:r</span> node return-maybe<span style="color: #797979;">]</span><span style="color: #B380A8;">}</span>
     bind-maybe<span style="color: #B380A8;">}</span>
    bind-maybe<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">begin</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.l</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.l</span> tree-zip<span style="color: #797979;">]</span> <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:l!</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:t1</span> <span style="color: #ae81ff;">.r</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #ae81ff;">.r</span> zip-tree<span style="color: #797979;">]</span> <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:r!</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:l</span> <span style="color: #a6e22e;">:r</span> node return-maybe<span style="color: #797979;">]</span><span style="color: #B380A8;">}</span> bind-maybe<span style="color: #B380A8;">}</span> bind-maybe<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> let-bind let-bind/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> let-bind/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> let-bind/expend-recur<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> let-bind/expend-recur <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:binder</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:rest</span> list-length <span style="color: #ae81ff;">1</span> eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.car</span><span style="color: #797979;">]</span>

    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.car</span> local-jo?<span style="color: #797979;">]</span>
    `<span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span><span style="color: #696969;">)</span>
      <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.car</span> local-jo-&gt;set-local-jo
          <span style="color: #a6e22e;">:binder</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
      <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:binder</span><span style="color: #696969;">)</span><span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    `<span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.car</span><span style="color: #696969;">)</span>
      <span style="color: #B380A8;">{</span>drop
       <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:binder</span> <span style="color: #a6e22e;">:rest</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
      <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:binder</span><span style="color: #696969;">)</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org586e5b2" class="outline-3">
<h3 id="org586e5b2">(case)</h3>
<div class="outline-text-3" id="text-org586e5b2">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+macro</span> case case/expend<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> case/expend <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">begin</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span><span style="color: #696969;">))</span> <span style="color: #B380A8;">{</span>tag<span style="color: #B380A8;">}</span> list-map
     <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> case/expend-rest<span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> case/expend-rest <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> list-length <span style="color: #ae81ff;">2</span> eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> case/expend-if-then
     `<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #e6db74;">"- runtime (case) miss match"</span> string-write newline
            <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
     list-append<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> case/expend-if-then
     `<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">))</span>
     list-append<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> case/expend-if-then <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tags</span> <span style="color: #a6e22e;">:answer</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tags</span> '<span style="color: #66d9ef; font-weight: bold;">else</span> eq?<span style="color: #797979;">]</span>
        `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
             <span style="color: #66d9ef; font-weight: bold;">then</span> drop <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:answer</span><span style="color: #696969;">))</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tags</span> cons?<span style="color: #797979;">]</span>
        `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:tags</span> <span style="color: #ae81ff;">.cdr</span><span style="color: #696969;">))</span> <span style="color: #B380A8;">{</span>case/match?<span style="color: #B380A8;">}</span> list-eqv?
             <span style="color: #66d9ef; font-weight: bold;">then</span> drop <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:answer</span><span style="color: #696969;">))</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span>
        `<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup <span style="color: #ae81ff;">.car</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:tags</span><span style="color: #696969;">))</span> case/match?
             <span style="color: #66d9ef; font-weight: bold;">then</span> drop <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> :answer<span style="color: #696969;">))))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> case/match? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tag1</span> <span style="color: #a6e22e;">:tag2</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tag1</span> underscore-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tag2</span> underscore-jo?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:tag1</span> <span style="color: #a6e22e;">:tag2</span> eq?<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d6337a" class="outline-3">
<h3 id="org3d6337a">(+var)</h3>
<div class="outline-text-3" id="text-org3d6337a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +var <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #fd971f;">:body!</span>
  'mark <span style="color: #a6e22e;">:body</span> cons
  'collect tail-cons
  body-run <span style="color: #fd971f;">:array!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:array</span> array-length <span style="color: #ae81ff;">1</span> eq? <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #a6e22e;">:array</span> <span style="color: #ae81ff;">0</span> array-ref <span style="color: #a6e22e;">:name</span> name-bind <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"- (+var) fail"</span> w nl
  <span style="color: #e6db74;">"  body eval to not one value"</span> w nl
  <span style="color: #e6db74;">"  name : "</span> w <span style="color: #a6e22e;">:name</span> w nl
  <span style="color: #e6db74;">"  body : "</span> w <span style="color: #a6e22e;">:body</span> w nl
  <span style="color: #e6db74;">"  number of values : "</span> w <span style="color: #a6e22e;">:array</span> array-length w nl
  <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3eba81a" class="outline-3">
<h3 id="org3eba81a">(set)</h3>
<div class="outline-text-3" id="text-org3eba81a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> set <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  `<span style="color: #696969;">((</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:name</span><span style="color: #696969;">))</span> name-rebind<span style="color: #696969;">)</span>
  begin<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org18adfcc" class="outline-3">
<h3 id="org18adfcc">(get)</h3>
<div class="outline-text-3" id="text-org18adfcc">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> get <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  `<span style="color: #696969;">((</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:name</span><span style="color: #696969;">))</span> name-get<span style="color: #696969;">)</span>
  begin<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org85cae79" class="outline-3">
<h3 id="org85cae79">(+atom)</h3>
<div class="outline-text-3" id="text-org85cae79">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +atom <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:gc-actor-name!</span>
  `<span style="color: #696969;">((</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:gc-actor-name</span><span style="color: #696969;">))</span> name-get
    <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">quote</span> <span style="color: #696969;">(</span><span style="color: #ae81ff;">@</span> <span style="color: #a6e22e;">:name</span><span style="color: #696969;">))</span> name-bind-atom<span style="color: #696969;">)</span>
  begin<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgbcd30ad" class="outline-2">
<h2 id="orgbcd30ad">monad</h2>
<div class="outline-text-2" id="text-orgbcd30ad">
</div><div id="outline-container-org74a91ff" class="outline-3">
<h3 id="org74a91ff"><span class="todo _note_">[note]</span> bind and compose can implement each ohter</h3>
<div class="outline-text-3" id="text-org74a91ff">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> bind
    <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:1m</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:&lt;1&gt;</span> <span style="color: #797979;">]</span><span style="color: #696969;">)</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:1-2m</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;2&gt;</span> <span style="color: #696969;">))</span>
     <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:2m</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:&lt;2&gt;</span> <span style="color: #797979;">]</span><span style="color: #696969;">))</span>
    dummy <span style="color: #B380A8;">{</span>drop <span style="color: #a6e22e;">:1m</span><span style="color: #B380A8;">}</span> <span style="color: #a6e22e;">:1-2m</span> compose apply<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> compose
    <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:0-1m</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;0&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;1&gt;</span> <span style="color: #696969;">))</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:1-2m</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;1&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;2&gt;</span> <span style="color: #696969;">))</span>
     <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #a6e22e;">:0-2m</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:&lt;0&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:&lt;2&gt;</span> <span style="color: #696969;">)))</span>
    <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:0-1m</span> apply <span style="color: #a6e22e;">:1-2m</span> bind<span style="color: #B380A8;">}</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org52cf45e" class="outline-3">
<h3 id="org52cf45e">maybe monad</h3>
<div class="outline-text-3" id="text-org52cf45e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;nothing&gt;</span><span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;just&gt;</span> .v<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> return-maybe just<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> bind-maybe <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:m</span> <span style="color: #a6e22e;">:v-&gt;m</span> <span style="color: #66d9ef; font-weight: bold;">--</span> maybe<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:m</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;nothing&gt;</span> nothing
    <span style="color: #66d9ef; font-weight: bold;">&lt;just&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:m</span> <span style="color: #ae81ff;">.v</span> <span style="color: #a6e22e;">:v-&gt;m</span> apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2c75974" class="outline-3">
<h3 id="org2c75974"><span class="todo _gt__lt_">&gt;&lt;</span> list monad</h3>
<div class="outline-text-3" id="text-org2c75974">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> return-list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> bind-list<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org41124b5" class="outline-2">
<h2 id="org41124b5">pair</h2>
<div class="outline-text-2" id="text-org41124b5">
</div><div id="outline-container-org9ad1409" class="outline-3">
<h3 id="org9ad1409">&lt;pair&gt;</h3>
<div class="outline-text-3" id="text-org9ad1409">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;pair&gt;</span> <span style="color: #ae81ff;">.l</span> <span style="color: #ae81ff;">.r</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgaa06941" class="outline-2">
<h2 id="orgaa06941">combinator</h2>
<div class="outline-text-2" id="text-orgaa06941">
</div><div id="outline-container-orge77887" class="outline-3">
<h3 id="orge77887">times</h3>
<div class="outline-text-3" id="text-orge77887">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> <span style="color: #66d9ef; font-weight: bold;">times</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #a6e22e;">:n</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:n</span> <span style="color: #ae81ff;">0</span> lteq? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:fun</span> apply
  <span style="color: #a6e22e;">:fun</span> <span style="color: #a6e22e;">:n</span> dec <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgd5e41b5" class="outline-2">
<h2 id="orgd5e41b5">w &#x2013; write &#x2013; gene</h2>
<div class="outline-text-2" id="text-orgd5e41b5">
</div><div id="outline-container-orgbde78e1" class="outline-3">
<h3 id="orgbde78e1">w</h3>
<div class="outline-text-3" id="text-orgbde78e1">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> write w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+gene</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> <span style="color: #a6e22e;">:x</span> data-print<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;int&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> int-write<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> string-write<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;jo&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> jo-write<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;byte&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> <span style="color: #e6db74;">"(byte "</span> w byte-write <span style="color: #e6db74;">")"</span> w<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7068e01" class="outline-3">
<h3 id="org7068e01">list-write</h3>
<div class="outline-text-3" id="text-org7068e01">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> drop <span style="color: #e6db74;">"()"</span> w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> list-write<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"("</span> w <span style="color: #a6e22e;">:list</span> list-write/loop <span style="color: #e6db74;">")"</span> w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-write/loop <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> null?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> w<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> w space
          <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb7dbab5" class="outline-3">
<h3 id="orgb7dbab5">array-write</h3>
<div class="outline-text-3" id="text-orgb7dbab5">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;array&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span> array-write<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:array</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:array</span> array-length <span style="color: #ae81ff;">0</span> eq? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #e6db74;">"(array)"</span> w <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"(array "</span> w <span style="color: #a6e22e;">:array</span> <span style="color: #ae81ff;">0</span> array-write/loop <span style="color: #e6db74;">")"</span> w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> array-write/loop <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:index</span> <span style="color: #a6e22e;">:array</span> array-length <span style="color: #ae81ff;">1</span> sub eq? <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> array-ref w <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> array-ref w space
  <span style="color: #a6e22e;">:array</span> <span style="color: #a6e22e;">:index</span> inc <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4bf6a97" class="outline-3">
<h3 id="org4bf6a97">pair-write</h3>
<div class="outline-text-3" id="text-org4bf6a97">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;pair&gt;</span><span style="color: #696969;">)</span> pair-write<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> pair-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:pair</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:pair</span> <span style="color: #ae81ff;">.l</span> w space
  <span style="color: #a6e22e;">:pair</span> <span style="color: #ae81ff;">.r</span> w space
  <span style="color: #e6db74;">"pair"</span> w<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org216abcb" class="outline-3">
<h3 id="org216abcb">nl</h3>
<div class="outline-text-3" id="text-org216abcb">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> nl newline<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgfef913e" class="outline-2">
<h2 id="orgfef913e">equal? &#x2013; gene</h2>
<div class="outline-text-2" id="text-orgfef913e">
</div><div id="outline-container-org894a5a4" class="outline-3">
<h3 id="org894a5a4">equal?</h3>
<div class="outline-text-3" id="text-org894a5a4">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+gene</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span> <span style="color: #a6e22e;">:x</span> <span style="color: #a6e22e;">:y</span> eq?<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;string&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span> string-eq?<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:x</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:y</span> <span style="color: #ae81ff;">.car</span> equal? not
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:x</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:y</span> <span style="color: #ae81ff;">.cdr</span> equal?<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;array&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;array&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span>equal?<span style="color: #B380A8;">}</span> array-eqv?<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">&lt;pair&gt;</span> <span style="color: #a6e22e;">:y</span> <span style="color: #66d9ef; font-weight: bold;">&lt;pair&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:x</span> <span style="color: #ae81ff;">.l</span> <span style="color: #a6e22e;">:y</span> <span style="color: #ae81ff;">.l</span> equal? not
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:x</span> <span style="color: #ae81ff;">.r</span> <span style="color: #a6e22e;">:y</span> <span style="color: #ae81ff;">.r</span> equal?<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org82634a5" class="outline-2">
<h2 id="org82634a5">more list</h2>
<div class="outline-text-2" id="text-org82634a5">
</div><div id="outline-container-org8a19bfc" class="outline-3">
<h3 id="org8a19bfc">list-foldr</h3>
<div class="outline-text-3" id="text-org8a19bfc">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-foldr <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> a <span style="color: #a6e22e;">:list</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:b</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:a-b-&gt;b</span> <span style="color: #66d9ef; font-weight: bold;">--</span> b<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #a6e22e;">:b</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span>
            <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:b</span> <span style="color: #a6e22e;">:a-b-&gt;b</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #a6e22e;">:a-b-&gt;b</span> apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc352e5d" class="outline-3">
<h3 id="orgc352e5d">list-foldl</h3>
<div class="outline-text-3" id="text-orgc352e5d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-foldl <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> a <span style="color: #a6e22e;">:list</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:b</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #a6e22e;">:b-a-&gt;b</span> <span style="color: #66d9ef; font-weight: bold;">--</span> b<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> <span style="color: #a6e22e;">:b</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #a6e22e;">:b</span> <span style="color: #a6e22e;">:b-a-&gt;b</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span>
            <span style="color: #a6e22e;">:b-a-&gt;b</span> apply<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbeee8ae" class="outline-3">
<h3 id="orgbeee8ae">list-member?</h3>
<div class="outline-text-3" id="text-orgbeee8ae">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-member? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:x</span> equal?<span style="color: #B380A8;">}</span> list-any?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9116018" class="outline-2">
<h2 id="org9116018">table</h2>
<div class="outline-text-2" id="text-org9116018">
</div><div id="outline-container-orgaa3d418" class="outline-3">
<h3 id="orgaa3d418">&lt;null-table&gt; &amp; &lt;cons-table&gt;</h3>
<div class="outline-text-3" id="text-orgaa3d418">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;null-table&gt;</span><span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+data</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons-table&gt;</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #ae81ff;">.key</span> <span style="color: #ae81ff;">.value</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4dce8aa" class="outline-3">
<h3 id="org4dce8aa">table?</h3>
<div class="outline-text-3" id="text-org4dce8aa">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:x</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:x</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null-table&gt;</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons-table&gt;</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3515843" class="outline-3">
<h3 id="org3515843">list-&gt;table</h3>
<div class="outline-text-3" id="text-org3515843">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-&gt;table <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:list</span> list-length odd? <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #e6db74;">"- list-&gt;table fail"</span> w nl
      <span style="color: #e6db74;">"  length of list is not even"</span> w nl
      <span style="color: #e6db74;">"  length : "</span> w <span style="color: #a6e22e;">:list</span> list-length w nl
      <span style="color: #e6db74;">"  list : "</span> w <span style="color: #a6e22e;">:list</span> w nl
      <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> list-&gt;table/recur<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-&gt;table/recur <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span> <span style="color: #a6e22e;">:list</span>
    <span style="color: #66d9ef; font-weight: bold;">&lt;null&gt;</span> null-table
    <span style="color: #66d9ef; font-weight: bold;">&lt;cons&gt;</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:list</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span>
            cons-table<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcde495e" class="outline-3">
<h3 id="orgcde495e">table</h3>
<div class="outline-text-3" id="text-orgcde495e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table list macro-compile 'list-&gt;table jo-emit<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2cb918c" class="outline-3">
<h3 id="org2cb918c">table-write</h3>
<div class="outline-text-3" id="text-org2cb918c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;null-table&gt;</span><span style="color: #696969;">)</span> drop <span style="color: #e6db74;">"(table)"</span> w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+disp</span> w <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;cons-table&gt;</span><span style="color: #696969;">)</span> table-write<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-write <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:table</span> null-table? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #e6db74;">"(table)"</span> w <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"(table "</span> w <span style="color: #a6e22e;">:table</span> table-write/loop <span style="color: #e6db74;">")"</span> w<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-write/loop <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> null-table?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
    <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> null-table?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> w space <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.value</span> w<span style="color: #797979;">]</span>
    <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> w space <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.value</span> w comma w space
          <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgccb3432" class="outline-3">
<h3 id="orgccb3432">table-find</h3>
<div class="outline-text-3" id="text-orgccb3432">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-find <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">--</span> value <span style="color: #66d9ef; font-weight: bold;">true</span> or <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> null-table?<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:key</span> equal?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.value</span> <span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #a6e22e;">:key</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org156625" class="outline-3">
<h3 id="org156625">table-contain?</h3>
<div class="outline-text-3" id="text-org156625">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-contain? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:large</span> <span style="color: #a6e22e;">:small</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:small</span> null-table?<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:large</span> <span style="color: #a6e22e;">:small</span> <span style="color: #ae81ff;">.key</span> table-find<span style="color: #797979;">]</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:small</span> <span style="color: #ae81ff;">.value</span> equal?
            <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:large</span> <span style="color: #a6e22e;">:small</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b4cdb4" class="outline-3">
<h3 id="org7b4cdb4">table-merge</h3>
<div class="outline-text-3" id="text-org7b4cdb4">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-merge <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:base</span> <span style="color: #a6e22e;">:src</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table <span style="color: #66d9ef; font-weight: bold;">true</span> or key <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:src</span> null-table?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:base</span> <span style="color: #66d9ef; font-weight: bold;">true</span><span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:base</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.key</span> table-find<span style="color: #797979;">]</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.value</span> equal?
            <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:base</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
            <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.key</span> <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:base</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.value</span> cons-table
              <span style="color: #a6e22e;">:src</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7f2bc5c" class="outline-3">
<h3 id="org7f2bc5c">table-equal?</h3>
<div class="outline-text-3" id="text-org7f2bc5c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-equal? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:t1</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:t1</span> <span style="color: #a6e22e;">:t2</span> table-contain? not
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #66d9ef; font-weight: bold;">end</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:t2</span> <span style="color: #a6e22e;">:t1</span> table-contain?<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc2a625f" class="outline-3">
<h3 id="orgc2a625f">table-key-filter</h3>
<div class="outline-text-3" id="text-orgc2a625f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-key-filter <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:table</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> null-table?<span style="color: #797979;">]</span> null-table
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
         <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.value</span> cons-table<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">recur</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd19fc12" class="outline-3">
<h3 id="orgd19fc12">table-key-map</h3>
<div class="outline-text-3" id="text-orgd19fc12">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> table-key-map <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #a6e22e;">:table</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> null-table?<span style="color: #797979;">]</span> null-table
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.rest</span> <span style="color: #a6e22e;">:fun</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
              <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.key</span> <span style="color: #a6e22e;">:fun</span> apply
              <span style="color: #a6e22e;">:table</span> <span style="color: #ae81ff;">.value</span> cons-table<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org89a4504" class="outline-2">
<h2 id="org89a4504">byte</h2>
<div class="outline-text-2" id="text-org89a4504">
</div><div id="outline-container-orgc31b47f" class="outline-3">
<h3 id="orgc31b47f">(byte)</h3>
<div class="outline-text-3" id="text-orgc31b47f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> byte <span style="color: #B380A8;">{</span>jo-&gt;byte emit-lit<span style="color: #B380A8;">}</span> list-for-each<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org6a88bd" class="outline-2">
<h2 id="org6a88bd">system</h2>
<div class="outline-text-2" id="text-org6a88bd">
</div><div id="outline-container-orgab0afea" class="outline-3">
<h3 id="orgab0afea">cmd-list</h3>
<div class="outline-text-3" id="text-orgab0afea">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cmd-list <span style="color: #ae81ff;">0</span> cmd-list/loop<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> cmd-list/loop <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:index</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:index</span> cmd-number eq?<span style="color: #797979;">]</span> null
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:index</span> index-&gt;cmd-string
              <span style="color: #a6e22e;">:index</span> inc <span style="color: #66d9ef; font-weight: bold;">recur</span>
              cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org650712b" class="outline-3">
<h3 id="org650712b">dash-prefixed-string?</h3>
<div class="outline-text-3" id="text-org650712b">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> dash-prefixed-string? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:str</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:str</span> string-length <span style="color: #ae81ff;">1</span> lt?<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:str</span> <span style="color: #ae81ff;">0</span> string-ref <span style="color: #696969;">(</span>byte -<span style="color: #696969;">)</span> eq?<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd2557b1" class="outline-3">
<h3 id="orgd2557b1">usr-jojo-dir</h3>
<div class="outline-text-3" id="text-orgd2557b1">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> usr-jojo-dir
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"USR_JOJO_DIR"</span> find-env-string<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
        <span style="color: #797979;">[</span><span style="color: #e6db74;">"HOME"</span> find-env-string<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"/.jojo"</span> string-append<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"- usr-jojo-dir fail"</span> w nl
              <span style="color: #e6db74;">"  system env USR_JOJO_DIR is empty"</span> w nl
              <span style="color: #e6db74;">"  system env HOME is empty"</span> w nl
              <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4ea733c" class="outline-3">
<h3 id="org4ea733c">sys-jojo-dir</h3>
<div class="outline-text-3" id="text-org4ea733c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sys-jojo-dir
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #e6db74;">"SYS_JOJO_DIR"</span> find-env-string<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #e6db74;">"/usr/lib/jojo"</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf2c17d0" class="outline-2">
<h2 id="orgf2c17d0">&lt;lib&gt;</h2>
<div class="outline-text-2" id="text-orgf2c17d0">
</div><div id="outline-container-orgd57695c" class="outline-3">
<h3 id="orgd57695c">lib-load</h3>
<div class="outline-text-3" id="text-orgd57695c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> lib-load current-reading-dir swap string-append lib-open<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9dec5b3" class="outline-2">
<h2 id="org9dec5b3">&lt;file&gt;</h2>
<div class="outline-text-2" id="text-org9dec5b3">
</div><div id="outline-container-orgb7db018" class="outline-3">
<h3 id="orgb7db018">maybe-drop-shabang</h3>
<div class="outline-text-3" id="text-orgb7db018">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> maybe-drop-shabang
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;input-stack&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;input-stack&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup input-stack-empty? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  reading-stack-push
  read-line <span style="color: #fd971f;">:line!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:line</span> string-length <span style="color: #ae81ff;">3</span> lteq?<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:line</span> string-unread<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:line</span> <span style="color: #ae81ff;">0</span> <span style="color: #ae81ff;">2</span> string-slice <span style="color: #e6db74;">"#!"</span> string-eq?<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:line</span> string-unread<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  reading-stack-pop<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3fe6ba2" class="outline-3">
<h3 id="org3fe6ba2">input-stack-read-sexp-list</h3>
<div class="outline-text-3" id="text-org3fe6ba2">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> input-stack-read-sexp-list
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;input-stack&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp list<span style="color: #696969;">)</span>
  reading-stack-push
  read-sexp-list-to-the-end
  reading-stack-pop input-stack-free<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd41e867" class="outline-3">
<h3 id="orgd41e867">read-sexp-list-to-the-end</h3>
<div class="outline-text-3" id="text-orgd41e867">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> read-sexp-list-to-the-end <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> has-jo? not <span style="color: #66d9ef; font-weight: bold;">then</span> null <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  read-sexp <span style="color: #66d9ef; font-weight: bold;">recur</span> cons<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org14be9ce" class="outline-3">
<h3 id="org14be9ce">absolute-path?</h3>
<div class="outline-text-3" id="text-org14be9ce">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> absolute-path? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:path</span> string-length <span style="color: #ae81ff;">0</span> eq? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:path</span> <span style="color: #ae81ff;">0</span> string-ref <span style="color: #696969;">(</span>byte /<span style="color: #696969;">)</span> eq?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2e1352e" class="outline-3">
<h3 id="org2e1352e">path-&gt;reading-path</h3>
<div class="outline-text-3" id="text-org2e1352e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> path-&gt;reading-path <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">--</span> path<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:path</span> absolute-path?
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:path</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> current-reading-dir <span style="color: #a6e22e;">:path</span> string-append<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4d35d16" class="outline-3">
<h3 id="org4d35d16">path-readable?</h3>
<div class="outline-text-3" id="text-org4d35d16">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> path-readable? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:path</span> path-open-read
      <span style="color: #66d9ef; font-weight: bold;">then</span> file-close <span style="color: #66d9ef; font-weight: bold;">true</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> drop <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org50db635" class="outline-3">
<h3 id="org50db635">path-load</h3>
<div class="outline-text-3" id="text-org50db635">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> path-load <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:path</span> path-&gt;reading-path <span style="color: #fd971f;">:real-path!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:real-path</span> path-open-read<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #fd971f;">:file!</span>
         <span style="color: #a6e22e;">:file</span> file-input-stack
         maybe-drop-shabang
         repl
         <span style="color: #a6e22e;">:file</span> file-close<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #fd971f;">:error-number!</span>
              <span style="color: #e6db74;">"- path-load fail"</span> w nl
              <span style="color: #e6db74;">"  path : "</span> w <span style="color: #a6e22e;">:path</span> w nl
              <span style="color: #e6db74;">"  real-path : "</span> w <span style="color: #a6e22e;">:real-path</span> w nl
              <span style="color: #e6db74;">"  "</span> w <span style="color: #a6e22e;">:error-number</span> error-number-print nl
              <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgf19a8a0" class="outline-2">
<h2 id="orgf19a8a0">module</h2>
<div class="outline-text-2" id="text-orgf19a8a0">
</div><div id="outline-container-orgc1ee416" class="outline-3">
<h3 id="orgc1ee416"><span class="todo _note_">[note]</span> module system</h3>
<div class="outline-text-3" id="text-orgc1ee416">
<ul class="org-ul">
<li><p>a module in jojo is a global name</p><p>stores a table of exported names,</p></li>

<li><p>while a module in file system is a dir of files,</p><p>with a module.jo in the dir,</p><p>to store meta data of the module.</p></li>

<li><p>every module has a version,</p><p><ul class="org-ul"></p><p><li><p>in jojo, the global name</p><p>should be "&lt;module-name&gt;/&lt;version&gt;"</p></li></p><p><li><p>in file system, the dir of a module</p><p>should be "&lt;module-name&gt;/&lt;version&gt;/*"</p></li></ul></p></li>

<li><p>a module will be installed to "~/.jojo"</p><p>as "~/.jojo/modules/&lt;module-name&gt;/&lt;version&gt;/*"</p></li>

<li><p>module system solves two problems :</p><p></p><p><ul class="org-ul"></p><p><li><p>re-load problem :</p><p>when used by multiple clients,</p><p>a module should only be loaded once.</p></li></p><p></p><p><li><p>unique-name problem :</p><p>a name must be resolved to an unique-name</p></li></ul></p></li></ul>
</div>
</div>

<div id="outline-container-orgaed31b8" class="outline-3">
<h3 id="orgaed31b8">(+module)</h3>
<div class="outline-text-3" id="text-orgaed31b8">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> +module
  dup <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #fd971f;">:body!</span>

  <span style="color: #a6e22e;">:body</span> expend-include <span style="color: #fd971f;">:body!</span>

  <span style="color: #a6e22e;">:body</span> <span style="color: #a6e22e;">:name</span>
  module/generate-define-table-list
  <span style="color: #fd971f;">:define-table-list!</span>

  <span style="color: #a6e22e;">:define-table-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> table-merge not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #fd971f;">:key!</span>
       <span style="color: #e6db74;">"- (+module) fail to merge define-table-list"</span> w nl
       <span style="color: #e6db74;">"  define-table-list : "</span> w <span style="color: #a6e22e;">:define-table-list</span> w nl
       <span style="color: #e6db74;">"  key : "</span> w <span style="color: #a6e22e;">:key</span> w nl
       <span style="color: #e6db74;">"  module name : "</span> w <span style="color: #a6e22e;">:name</span> w nl
       <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
  null-table swap list-foldr <span style="color: #fd971f;">:define-table!</span>

  <span style="color: #a6e22e;">:body</span> <span style="color: #a6e22e;">:name</span>
  module/generate-export-table
  <span style="color: #fd971f;">:export-table!</span>

  <span style="color: #a6e22e;">:define-table</span>
  <span style="color: #a6e22e;">:export-table</span>
  module/export-check

  <span style="color: #a6e22e;">:body</span> module/collect-import-table-list
  <span style="color: #fd971f;">:import-table-list!</span>

  <span style="color: #a6e22e;">:import-table-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> table-merge not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #fd971f;">:key!</span>
       <span style="color: #e6db74;">"- (+module) fail to merge import-table-list"</span> w nl
       <span style="color: #e6db74;">"  import-table-list : "</span> w <span style="color: #a6e22e;">:import-table-list</span> w nl
       <span style="color: #e6db74;">"  key : "</span> w <span style="color: #a6e22e;">:key</span> w nl
       <span style="color: #e6db74;">"  module name : "</span> w <span style="color: #a6e22e;">:name</span> w nl
       <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
  null-table swap list-foldr <span style="color: #fd971f;">:import-table!</span>

  <span style="color: #a6e22e;">:import-table</span> <span style="color: #a6e22e;">:define-table</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> table-merge not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #fd971f;">:key!</span>
      <span style="color: #e6db74;">"- (+module) fail to merge import-table with define-table"</span> w nl
      <span style="color: #e6db74;">"  import-table : "</span> w <span style="color: #a6e22e;">:import-table</span> w nl
      <span style="color: #e6db74;">"  define-table : "</span> w <span style="color: #a6e22e;">:define-table</span> w nl
      <span style="color: #e6db74;">"  key : "</span> w <span style="color: #a6e22e;">:key</span> w nl
      <span style="color: #e6db74;">"  module name : "</span> w <span style="color: #a6e22e;">:name</span> w nl
      <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
  <span style="color: #fd971f;">:rename-table!</span>

  <span style="color: #a6e22e;">:body</span>
  <span style="color: #B380A8;">{</span>sexp-for-module? not<span style="color: #B380A8;">}</span> list-filter

  <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:rename-table</span> sexp-table-substitute<span style="color: #B380A8;">}</span> list-map

  sexp-list-compile

  <span style="color: #a6e22e;">:export-table</span>
  <span style="color: #a6e22e;">:name</span> name-bind<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdf6513d" class="outline-3">
<h3 id="orgdf6513d">expend-include</h3>
<div class="outline-text-3" id="text-orgdf6513d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> expend-include <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> body<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> null?<span style="color: #797979;">]</span> null
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> cons? not<span style="color: #797979;">]</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #ae81ff;">.car</span> 'include eq?<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #ae81ff;">.cdr</span> path-list-read-sexp-list
         <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
         list-append<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #66d9ef; font-weight: bold;">recur</span> cons<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7b6ea59" class="outline-3">
<h3 id="org7b6ea59">path-list-read-sexp-list</h3>
<div class="outline-text-3" id="text-org7b6ea59">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> path-list-read-sexp-list
  <span style="color: #B380A8;">{</span>path-read-sexp-list<span style="color: #B380A8;">}</span> list-map
  null <span style="color: #B380A8;">{</span>list-append<span style="color: #B380A8;">}</span> list-foldr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d447ee" class="outline-3">
<h3 id="org1d447ee">path-read-sexp-list</h3>
<div class="outline-text-3" id="text-org1d447ee">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> path-read-sexp-list <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:path</span> path-&gt;reading-path <span style="color: #fd971f;">:real-path!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:real-path</span> path-open-read<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #fd971f;">:file!</span> <span style="color: #a6e22e;">:file</span> file-input-stack
         input-stack-read-sexp-list
         <span style="color: #a6e22e;">:file</span> file-close<span style="color: #797979;">]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #797979;">[</span><span style="color: #fd971f;">:error-number!</span>
              <span style="color: #e6db74;">"- path-read-sexp-list fail"</span> w nl
              <span style="color: #e6db74;">"  path : "</span> w <span style="color: #a6e22e;">:path</span> w nl
              <span style="color: #e6db74;">"  real-path : "</span> w <span style="color: #a6e22e;">:real-path</span> w nl
              <span style="color: #e6db74;">"  "</span> w <span style="color: #a6e22e;">:error-number</span> error-number-print nl
              <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2f0342a" class="outline-3">
<h3 id="org2f0342a">list-car-filter</h3>
<div class="outline-text-3" id="text-org2f0342a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> list-car-filter <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> list <span style="color: #a6e22e;">:pred</span> <span style="color: #66d9ef; font-weight: bold;">--</span> list<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:x!</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:x</span> cons? not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
           <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:x</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:pred</span> apply<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
  list-filter<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3d25727" class="outline-3">
<h3 id="org3d25727">module/generate-define-table-list</h3>
<div class="outline-text-3" id="text-org3d25727">
</div><div id="outline-container-orgc1adcad" class="outline-4">
<h4 id="orgc1adcad">module/generate-define-table-list</h4>
<div class="outline-text-4" id="text-orgc1adcad">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-define-table-list
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table list<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span>
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-jojo-table
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-gene-table
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-disp-table
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-var-table
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-atom-table
    <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:name</span> module/generate-data-table<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9654163" class="outline-4">
<h4 id="org9654163">module/plus-filter</h4>
<div class="outline-text-4" id="text-org9654163">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/plus-filter
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:plus</span> <span style="color: #66d9ef; font-weight: bold;">--</span> name list<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span>
  <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:plus</span> eq?<span style="color: #B380A8;">}</span> list-car-filter
  <span style="color: #B380A8;">{</span><span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span><span style="color: #B380A8;">}</span> list-map<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgcd4afba" class="outline-4">
<h4 id="orgcd4afba">module/name-list-&gt;table</h4>
<div class="outline-text-4" id="text-orgcd4afba">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/name-list-&gt;table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name-list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:name-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:jo</span>
   <span style="color: #a6e22e;">:module-name</span> ': jo-append <span style="color: #a6e22e;">:jo</span> jo-append
   cons-table<span style="color: #B380A8;">}</span>
  null-table swap list-foldr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8c30c6" class="outline-4">
<h4 id="org8c30c6">module/generate-jojo-table</h4>
<div class="outline-text-4" id="text-org8c30c6">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-jojo-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+jojo module/plus-filter
  <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org68a8452" class="outline-4">
<h4 id="org68a8452">module/generate-gene-table</h4>
<div class="outline-text-4" id="text-org68a8452">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-gene-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+gene module/plus-filter
  <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge7ff16a" class="outline-4">
<h4 id="orge7ff16a">module/generate-disp-table</h4>
<div class="outline-text-4" id="text-orge7ff16a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-disp-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+disp module/plus-filter
  <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge09794a" class="outline-4">
<h4 id="orge09794a">module/generate-var-table</h4>
<div class="outline-text-4" id="text-orge09794a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-var-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+var module/plus-filter
  <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga4d0671" class="outline-4">
<h4 id="orga4d0671">module/tag-list-&gt;table</h4>
<div class="outline-text-4" id="text-orga4d0671">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/tag-list-&gt;table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:tag-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:jo</span>
   <span style="color: #a6e22e;">:module-name</span> ': jo-append
   <span style="color: #a6e22e;">:jo</span> tag-jo-&gt;jo jo-append
   jo-&gt;tag-jo
   cons-table<span style="color: #B380A8;">}</span>
  null-table swap list-foldr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org488f2b0" class="outline-4">
<h4 id="org488f2b0">module/tag-list-&gt;predicate-table</h4>
<div class="outline-text-4" id="text-org488f2b0">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/tag-list-&gt;predicate-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:tag-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:jo</span> tag-jo-&gt;jo '? jo-append
   <span style="color: #a6e22e;">:module-name</span> ': jo-append
   <span style="color: #a6e22e;">:jo</span> tag-jo-&gt;jo jo-append
   '? jo-append
   cons-table<span style="color: #B380A8;">}</span>
  null-table swap list-foldr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc848bad" class="outline-4">
<h4 id="orgc848bad">module/tag-list-&gt;constructor-table</h4>
<div class="outline-text-4" id="text-orgc848bad">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/tag-list-&gt;constructor-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:tag-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:jo</span> tag-jo-&gt;jo
   <span style="color: #a6e22e;">:module-name</span> ': jo-append
   <span style="color: #a6e22e;">:jo</span> tag-jo-&gt;jo jo-append
   cons-table<span style="color: #B380A8;">}</span>
  null-table swap list-foldr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org523e2fd" class="outline-4">
<h4 id="org523e2fd">module/generate-atom-table</h4>
<div class="outline-text-4" id="text-org523e2fd">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-atom-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+atom module/plus-filter <span style="color: #fd971f;">:tag-list!</span>
  <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;table
  <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;predicate-table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd41dc7" class="outline-4">
<h4 id="orgdd41dc7">module/generate-data-table</h4>
<div class="outline-text-4" id="text-orgdd41dc7">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-data-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table table table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span> '+data module/plus-filter <span style="color: #fd971f;">:tag-list!</span>
  <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;table
  <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;predicate-table
  <span style="color: #a6e22e;">:tag-list</span> <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;constructor-table<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org9aa910a" class="outline-3">
<h3 id="org9aa910a">module/generate-export-table</h3>
<div class="outline-text-3" id="text-org9aa910a">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-export-table
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:list</span>
  <span style="color: #B380A8;">{</span>'export eq?<span style="color: #B380A8;">}</span>
  list-car-filter <span style="color: #B380A8;">{</span><span style="color: #ae81ff;">.cdr</span><span style="color: #B380A8;">}</span> list-map
  null <span style="color: #B380A8;">{</span>list-append<span style="color: #B380A8;">}</span> list-foldr
  <span style="color: #B380A8;">{</span>tag-jo? not<span style="color: #B380A8;">}</span> list-filter <span style="color: #fd971f;">:name-list!</span>

  <span style="color: #a6e22e;">:name-list</span> <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/generate-export-table
    <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:list</span> <span style="color: #a6e22e;">:module-name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
    <span style="color: #a6e22e;">:list</span>
    <span style="color: #B380A8;">{</span>'export eq?<span style="color: #B380A8;">}</span>
    list-car-filter <span style="color: #B380A8;">{</span><span style="color: #ae81ff;">.cdr</span><span style="color: #B380A8;">}</span> list-map
    null <span style="color: #B380A8;">{</span>list-append<span style="color: #B380A8;">}</span> list-foldr

    dup <span style="color: #B380A8;">{</span>tag-jo?<span style="color: #B380A8;">}</span> list-filter <span style="color: #fd971f;">:tag-list!</span>
    <span style="color: #B380A8;">{</span>tag-jo? not<span style="color: #B380A8;">}</span> list-filter <span style="color: #fd971f;">:name-list!</span>

    <span style="color: #a6e22e;">:name-list</span> <span style="color: #a6e22e;">:module-name</span> module/name-list-&gt;table
    <span style="color: #a6e22e;">:tag-list</span>  <span style="color: #a6e22e;">:module-name</span> module/tag-list-&gt;table

    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> table-merge not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #fd971f;">:key!</span>
        <span style="color: #e6db74;">"- (module/generate-export-table)"</span> w nl
        <span style="color: #e6db74;">"  fail to merge export tables"</span> w nl
        <span style="color: #e6db74;">"  key : "</span> w <span style="color: #a6e22e;">:key</span> w nl
        <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgde5fe08" class="outline-3">
<h3 id="orgde5fe08">module/export-check</h3>
<div class="outline-text-3" id="text-orgde5fe08">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/export-check
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:define-table</span> <span style="color: #a6e22e;">:export-table</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:define-table</span> <span style="color: #a6e22e;">:export-table</span> table-contain? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"- module/export-check fail"</span> w nl
  <span style="color: #e6db74;">"  define-table does not contain export-table"</span> w nl
  <span style="color: #e6db74;">"  define-table : "</span> w <span style="color: #a6e22e;">:define-table</span> w nl
  <span style="color: #e6db74;">"  export-table : "</span> w <span style="color: #a6e22e;">:export-table</span> w nl
  <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgad77ec6" class="outline-3">
<h3 id="orgad77ec6">module/collect-import-table-list</h3>
<div class="outline-text-3" id="text-orgad77ec6">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/collect-import-table-list
  <span style="color: #B380A8;">{</span>'import eq?<span style="color: #B380A8;">}</span> list-car-filter
  <span style="color: #B380A8;">{</span><span style="color: #ae81ff;">.cdr</span> module/import-one<span style="color: #B380A8;">}</span> list-map<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org79b1629" class="outline-3">
<h3 id="org79b1629">module/import-one</h3>
<div class="outline-text-3" id="text-org79b1629">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module/import-one <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> <span style="color: #ae81ff;">.car</span> <span style="color: #fd971f;">:name!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:name</span> module-loaded? not <span style="color: #66d9ef; font-weight: bold;">then</span>
      <span style="color: #a6e22e;">:name</span> module-load<span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> body-run <span style="color: #fd971f;">:result!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:result</span> table? <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:result</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #e6db74;">"- module/import-one fail"</span> w nl
  <span style="color: #e6db74;">"  result of body is not table"</span> w nl
  <span style="color: #e6db74;">"  body : "</span> w <span style="color: #a6e22e;">:body</span> w nl
  <span style="color: #e6db74;">"  result : "</span> w <span style="color: #a6e22e;">:result</span> w nl
  <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5bd6b7d" class="outline-3">
<h3 id="org5bd6b7d">sexp-for-module?</h3>
<div class="outline-text-3" id="text-org5bd6b7d">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-for-module? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  '<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">import</span> export<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #fd971f;">:jo!</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:sexp</span> cons? not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #66d9ef; font-weight: bold;">false</span>
            <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:jo</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.car</span> eq?<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
  list-any?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbc44fa2" class="outline-3">
<h3 id="orgbc44fa2">sexp-table-substitute</h3>
<div class="outline-text-3" id="text-orgbc44fa2">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> sexp-table-substitute <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:sexp</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">--</span> sexp<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> cons?<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.car</span> <span style="color: #a6e22e;">:table</span> <span style="color: #66d9ef; font-weight: bold;">recur</span>
         <span style="color: #a6e22e;">:sexp</span> <span style="color: #ae81ff;">.cdr</span> <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:table</span> sexp-table-substitute<span style="color: #B380A8;">}</span> list-map
         cons<span style="color: #797979;">]</span>
        <span style="color: #797979;">[</span><span style="color: #a6e22e;">:table</span> <span style="color: #a6e22e;">:sexp</span> table-find<span style="color: #797979;">]</span> <span style="color: #797979;">[]</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #a6e22e;">:sexp</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org9438cca" class="outline-3">
<h3 id="org9438cca">module-loaded?</h3>
<div class="outline-text-3" id="text-org9438cca">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module-loaded? <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:name</span> jo-bound?
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:name</span> sexp-run table?
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5eedcfc" class="outline-3">
<h3 id="org5eedcfc">module-find-path</h3>
<div class="outline-text-3" id="text-org5eedcfc">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module-find-path-from-dir
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:dir</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> path <span style="color: #66d9ef; font-weight: bold;">true</span> or <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:dir</span> <span style="color: #e6db74;">"/modules/"</span> string-append
  <span style="color: #a6e22e;">:name</span> jo-&gt;string string-append
  <span style="color: #e6db74;">"/module.jo"</span> string-append <span style="color: #fd971f;">:path!</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:path</span> path-readable?
      <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #a6e22e;">:path</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
      <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module-find-path
  <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> path <span style="color: #66d9ef; font-weight: bold;">true</span> or <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span> <span style="color: #797979;">[</span>current-running-dir <span style="color: #a6e22e;">:name</span> module-find-path-from-dir<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
        <span style="color: #797979;">[</span>usr-jojo-dir <span style="color: #a6e22e;">:name</span> module-find-path-from-dir<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
        <span style="color: #797979;">[</span>sys-jojo-dir <span style="color: #a6e22e;">:name</span> module-find-path-from-dir<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">true</span>
        <span style="color: #66d9ef; font-weight: bold;">else</span> <span style="color: #66d9ef; font-weight: bold;">false</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd85875" class="outline-3">
<h3 id="orgbd85875">module-load</h3>
<div class="outline-text-3" id="text-orgbd85875">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> module-load <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> <span style="color: #a6e22e;">:name</span> module-find-path
      <span style="color: #66d9ef; font-weight: bold;">then</span> path-load
      <span style="color: #66d9ef; font-weight: bold;">else</span>
      <span style="color: #e6db74;">"- module-load fail"</span> w nl
      <span style="color: #e6db74;">"  can not find module : "</span> w <span style="color: #a6e22e;">:name</span> w nl
      <span style="color: #e6db74;">"  current-reading-dir : "</span> w current-reading-dir w nl
      <span style="color: #e6db74;">"  usr-jojo-dir : "</span> w usr-jojo-dir w nl
      <span style="color: #e6db74;">"  sys-jojo-dir : "</span> w sys-jojo-dir w nl
      <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org209327" class="outline-3">
<h3 id="org209327">(run)</h3>
<div class="outline-text-3" id="text-org209327">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> run <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:body</span> <span style="color: #66d9ef; font-weight: bold;">--</span><span style="color: #696969;">)</span>
  <span style="color: #a6e22e;">:body</span> expend-include <span style="color: #fd971f;">:body!</span>

  <span style="color: #a6e22e;">:body</span> module/collect-import-table-list
  <span style="color: #fd971f;">:import-table-list!</span>

  <span style="color: #a6e22e;">:import-table-list</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> table-merge not <span style="color: #66d9ef; font-weight: bold;">then</span> <span style="color: #fd971f;">:key!</span>
       <span style="color: #e6db74;">"- (run) fail to merge import-table-list"</span> w nl
       <span style="color: #e6db74;">"  import-table-list : "</span> w <span style="color: #a6e22e;">:import-table-list</span> w nl
       <span style="color: #e6db74;">"  key : "</span> w <span style="color: #a6e22e;">:key</span> w nl
       <span style="color: #66d9ef; font-weight: bold;">debug</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span>
  null-table swap list-foldr <span style="color: #fd971f;">:import-table!</span>

  <span style="color: #a6e22e;">:import-table</span> <span style="color: #fd971f;">:rename-table!</span>

  <span style="color: #a6e22e;">:body</span>
  <span style="color: #B380A8;">{</span>sexp-for-module? not<span style="color: #B380A8;">}</span> list-filter
  <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:rename-table</span> sexp-table-substitute<span style="color: #B380A8;">}</span> list-map
  body-run<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd6a558d" class="outline-3">
<h3 id="orgd6a558d"><span class="todo _note_">[note]</span> table processing in module system</h3>
<div class="outline-text-3" id="text-orgd6a558d">
<ul class="org-ul">
<li><p><p></p><p>we can use table processing functions</p><p>to handle the name unique-name binding</p><p></p></p><p></p><p><div class="org-src-container"></p><p></p><p><pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> take r7rs import declaration for example</p><p>  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">import</span> <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span><span style="color: #696969;">)</span></p><p>  where <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span></p><p>  = <span style="color: #66d9ef; font-weight: bold;">&lt;library-name&gt;</span></p><p>  | <span style="color: #696969;">(</span>only <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;identifier&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span></p><p>  | <span style="color: #696969;">(</span>except <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;identifier&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span></p><p>  | <span style="color: #696969;">(</span>prefix <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;identifier&gt;</span><span style="color: #696969;">)</span></p><p>  | <span style="color: #696969;">(</span>rename <span style="color: #66d9ef; font-weight: bold;">&lt;import-set&gt;</span> <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">&lt;old-identifier&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;new-identifier&gt;</span><span style="color: #696969;">)</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> <span style="color: #696969;">)</span></p><p></p><p><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> in jojo we can use table processing functions like :</p><p>  '<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> only</p><p>  '<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> except</p><p>  <span style="color: #66d9ef; font-weight: bold;">&lt;prefix&gt;</span> prefix</p><p>  '<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">table</span> <span style="color: #66d9ef; font-weight: bold;">&lt;old&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;new&gt;</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> rename<span style="color: #696969;">)</span></p><p></p><p><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> but these names are too general</p><p>  for table processing functions</p><p>  we use the following instead :</p><p>  only  <span style="color: #FFA23D;"> : </span><span style="color: #B380A8;">{</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> eq?<span style="color: #B380A8;">}</span> table-key-filter</p><p>  except<span style="color: #FFA23D;"> : </span><span style="color: #B380A8;">{</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> eq? not<span style="color: #B380A8;">}</span> table-key-filter</p><p>  prefix<span style="color: #FFA23D;"> : </span><span style="color: #B380A8;">{</span><span style="color: #66d9ef; font-weight: bold;">&lt;prefix&gt;</span> swap jo-append<span style="color: #B380A8;">}</span> table-key-map</p><p>  rename<span style="color: #FFA23D;"> : </span><span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup <span style="color: #66d9ef; font-weight: bold;">&lt;old&gt;</span> eq? <span style="color: #66d9ef; font-weight: bold;">then</span> drop <span style="color: #66d9ef; font-weight: bold;">&lt;new&gt;</span> <span style="color: #66d9ef; font-weight: bold;">else</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span> table-key-map<span style="color: #696969;">)</span></p><p></p><p><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">note</span> we can abstract those special use of</p><p>  table processing functions :</p><p>  '<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> import-only</p><p>  '<span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">&lt;name&gt;</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> import-except</p><p>  <span style="color: #66d9ef; font-weight: bold;">&lt;prefix&gt;</span> import-prefix</p><p>  '<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">table</span> <span style="color: #66d9ef; font-weight: bold;">&lt;old&gt;</span> <span style="color: #66d9ef; font-weight: bold;">&lt;new&gt;</span><span style="color: #f92672; font-weight: bold;">,</span> <span style="color: #ae81ff;">...</span><span style="color: #696969;">)</span> import-rename<span style="color: #696969;">)</span></p><p></pre></p><p></div></p></li></ul>
</div>
</div>

<div id="outline-container-org24389ea" class="outline-3">
<h3 id="org24389ea">import-only</h3>
<div class="outline-text-3" id="text-org24389ea">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> import-only <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> table <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:list</span> <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:name</span> eq?<span style="color: #B380A8;">}</span> list-any?<span style="color: #B380A8;">}</span>
  table-key-filter<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org559fcd4" class="outline-3">
<h3 id="org559fcd4">import-except</h3>
<div class="outline-text-3" id="text-org559fcd4">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> import-except <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> table <span style="color: #a6e22e;">:list</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #a6e22e;">:name</span> <span style="color: #66d9ef; font-weight: bold;">--</span> <span style="color: #66d9ef; font-weight: bold;">&lt;bool&gt;</span><span style="color: #696969;">)</span>
   <span style="color: #a6e22e;">:list</span> <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:name</span> eq? not<span style="color: #B380A8;">}</span> list-any?<span style="color: #B380A8;">}</span>
  table-key-filter<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org44857c3" class="outline-3">
<h3 id="org44857c3">import-prefix</h3>
<div class="outline-text-3" id="text-org44857c3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> import-prefix <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> table <span style="color: #a6e22e;">:prefix-jo</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:prefix-jo</span> swap jo-append<span style="color: #B380A8;">}</span>
  table-key-map<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org5f875c8" class="outline-3">
<h3 id="org5f875c8">import-rename</h3>
<div class="outline-text-3" id="text-org5f875c8">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> import-rename <span style="color: #696969;">(</span><span style="color: #66d9ef; font-weight: bold;">-&gt;</span> table <span style="color: #a6e22e;">:renaming</span> <span style="color: #66d9ef; font-weight: bold;">--</span> table<span style="color: #696969;">)</span>
  <span style="color: #B380A8;">{</span><span style="color: #a6e22e;">:renaming</span> sexp-table-substitute<span style="color: #B380A8;">}</span>
  table-key-map<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgccb4807" class="outline-2">
<h2 id="orgccb4807">the-story-begin</h2>
<div class="outline-text-2" id="text-orgccb4807">
</div><div id="outline-container-org268a063" class="outline-3">
<h3 id="org268a063">welcome-to-jojo</h3>
<div class="outline-text-3" id="text-org268a063">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> welcome-to-jojo
  <span style="color: #e6db74;">"welcome to jojo's programming adventure ^-^/"</span> w nl<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org33b63f5" class="outline-3">
<h3 id="org33b63f5">the-story-begin</h3>
<div class="outline-text-3" id="text-org33b63f5">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">+jojo</span> the-story-begin
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">cond</span>
    <span style="color: #797979;">[</span>cmd-number <span style="color: #ae81ff;">1</span> eq?<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span>core-flag-off
     test-flag-off
     repl-flag-on
     welcome-to-jojo
     print-data-stack
     terminal-input-stack repl<span style="color: #797979;">]</span>

    <span style="color: #66d9ef; font-weight: bold;">else</span>
    <span style="color: #797979;">[</span>core-flag-off
     test-flag-off
     repl-flag-off
     cmd-list <span style="color: #ae81ff;">.cdr</span> <span style="color: #ae81ff;">.car</span> path-load<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

the-story-begin
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: xieyuheng</p>
<p class="date">Created: 2017-09-25 Mon 02:41</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
