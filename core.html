<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2016-07-07 Thu 03:32 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>example code of jojo</title>
<meta name="generator" content="Org-mode" />
<meta name="author" content="XIE Yuheng" />
<link rel="stylesheet" href="http://xieyuheng.github.io/asset/css/page.css" type="text/css" media="screen" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="preamble" class="status">
長悲嘆而掩面兮 憐其獨於夢睹
</div>
<div id="content">
<h1 class="title">example code of jojo</h1>
<div id="table-of-contents">
<h2>overview</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgfd9581f">define function</a></li>
<li><a href="#org1d6a7d3">loop by explicit tail-call</a></li>
<li><a href="#org656f8a0">branching by if</a></li>
<li><a href="#org807bd9e">receive function</a></li>
<li><a href="#org34373f6">int</a></li>
<li><a href="#org8ea2c69">string</a></li>
<li><a href="#org4055c93">byte</a></li>
<li><a href="#orgbf16c69">system</a></li>
<li><a href="#org68c7134">var</a></li>
<li><a href="#org3305016">jo</a></li>
<li><a href="#orgc67f382">list</a>
<ul>
<li><a href="#orgb3fe910">cons-area</a></li>
<li><a href="#orga9c4c93">cons-area/report</a></li>
<li><a href="#orgdaeefd0">sweep-cons-area</a></li>
<li><a href="#org7afacf7">mark-cons-area</a></li>
<li><a href="#orgf768499">cons</a></li>
<li><a href="#org1be8a45"><span class="done test">test</span> </a></li>
<li><a href="#org3aed435">list</a></li>
<li><a href="#org6118ba2"><span class="done test">test</span> </a></li>
<li><a href="#org979e98c">int-list/print</a></li>
<li><a href="#orge234a86"><span class="done test">test</span> </a></li>
<li><a href="#org4a616c2">jo/map &amp; jo/itr</a></li>
<li><a href="#orgfe26349"><span class="done test">test</span> </a></li>
<li><a href="#org2bd218c">map</a></li>
<li><a href="#org21fec27"><span class="done test">test</span> </a></li>
<li><a href="#org182ccb7">list/ref</a></li>
<li><a href="#orgf293b99"><span class="done test">test</span> </a></li>
<li><a href="#orgbfc500c">jo-list/print</a></li>
<li><a href="#orgdd5cdd1"><span class="done test">test</span> </a></li>
<li><a href="#orgec47731">string-list/print</a></li>
<li><a href="#orgd556a11"><span class="done test">test</span> </a></li>
</ul>
</li>
<li><a href="#orgff78e4c">case</a></li>
<li><a href="#org7ae8322">report</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgfd9581f" class="outline-2">
<h2 id="orgfd9581f">define function</h2>
<div class="outline-text-2" id="text-orgfd9581f">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">square</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> int int <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> int<span style="color: #696969;">)</span>
  dup mul <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 11<span style="color: #696969;">)</span> square dot<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1d6a7d3" class="outline-2">
<h2 id="org1d6a7d3">loop by explicit tail-call</h2>
<div class="outline-text-2" id="text-org1d6a7d3">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">key-jo/apply</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> jo <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> *<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup jo/used? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> jo/apply <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"undefined keyword : "</span><span style="color: #696969;">)</span> string/print
  jo-&gt;string string/print <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">stack-repl</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> *<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> read/jo round-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> read/jo key-jo/apply print-stack<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> stack-repl<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org656f8a0" class="outline-2">
<h2 id="org656f8a0">branching by if</h2>
<div class="outline-text-2" id="text-org656f8a0">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> true <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> true dot <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> false <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> false dot <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org807bd9e" class="outline-2">
<h2 id="org807bd9e">receive function</h2>
<div class="outline-text-2" id="text-org807bd9e">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">factorial</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> int <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> int<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> lteq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> sub <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">recur</span><span style="color: #696969;">)</span> mul <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> factorial dot
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> factorial dot
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> factorial dot
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> factorial dot
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span> factorial dot<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org34373f6" class="outline-2">
<h2 id="org34373f6">int</h2>
<div class="outline-text-2" id="text-org34373f6">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 18 5<span style="color: #696969;">)</span> mod dot<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0 3 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1 3 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> n-eq? dot<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1 3 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1 3 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> n-eq? dot<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org8ea2c69" class="outline-2">
<h2 id="org8ea2c69">string</h2>
<div class="outline-text-2" id="text-org8ea2c69">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"test1"</span> <span style="color: #e6db74;">"test2"</span><span style="color: #696969;">)</span>
     string/print string/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4055c93" class="outline-2">
<h2 id="org4055c93">byte</h2>
<div class="outline-text-2" id="text-org4055c93">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"test1"</span> <span style="color: #e6db74;">"test2"</span><span style="color: #696969;">)</span>
     dup <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 66<span style="color: #696969;">)</span> swap set-byte string/print
     dup get-byte dot string/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbf16c69" class="outline-2">
<h2 id="orgbf16c69">system</h2>
<div class="outline-text-2" id="text-orgbf16c69">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> current-dir string/print newline<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"HOME"</span><span style="color: #696969;">)</span> var-string-&gt;env-string
     string/print newline<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"PATH"</span><span style="color: #696969;">)</span> var-string-&gt;env-string
     string/print newline<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">command-line/print-argument/loop</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> index <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup argument-counter lt? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      dup index-&gt;argument-string string/print
      newline
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">command-line/print-argument</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> command-line/print-argument/loop<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> command-line/print-argument<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org68c7134" class="outline-2">
<h2 id="org68c7134">var</h2>
<div class="outline-text-2" id="text-org68c7134">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> var1 <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 666<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 666<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> var1 dot<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3305016" class="outline-2">
<h2 id="org3305016">jo</h2>
<div class="outline-text-2" id="text-org3305016">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> null<span style="color: #696969;">)</span> jo-&gt;string string/print newline<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc67f382" class="outline-2">
<h2 id="orgc67f382">list</h2>
<div class="outline-text-2" id="text-orgc67f382">
</div><div id="outline-container-orgb3fe910" class="outline-3">
<h3 id="orgb3fe910">cons-area</h3>
<div class="outline-text-3" id="text-orgb3fe910">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> cons-size <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> cell-size mul<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> cons-area-size
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 5<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> for testing<span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1024 1024<span style="color: #696969;">)</span> mul
  cons-size mul<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> cons-area cons-area-size allocate<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> cons-area-top cons-area cons-area-size add<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> cons-pointer cons-area<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> current-mark <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">))</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> max-mark <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> for testing<span style="color: #696969;">))</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1024 1024<span style="color: #696969;">)</span> mul<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons-pointer/next</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-pointer<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  cons-size cons-pointer add
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> cons-pointer<span style="color: #696969;">)</span> set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons-pointer/init</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-pointer<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  cons-area
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> cons-pointer<span style="color: #696969;">)</span> set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons-pointer/next-free</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-pointer<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> cons-pointer cons-area-top eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> cons-pointer get current-mark eq? not <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  cons-pointer/next
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons?</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cell <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> bool<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons-area lt? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop false <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons-area-top gteq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop false <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  cons-area sub cons-size mod <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> eq?<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orga9c4c93" class="outline-3">
<h3 id="orga9c4c93">cons-area/report</h3>
<div class="outline-text-3" id="text-orga9c4c93">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">declare</span>
  <span style="color: #696969;">(</span>car <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cell<span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span>cdr <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cell<span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons-area/report/loop</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons-area-top eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"#:"</span><span style="color: #696969;">)</span> string/print
  dup dot
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"mark: "</span><span style="color: #696969;">)</span> string/print
  dup get dot
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"car: "</span><span style="color: #696969;">)</span> string/print
  dup car dot
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"cdr: "</span><span style="color: #696969;">)</span> string/print
  dup cdr dot
  newline
  cons-size add
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons-area/report</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  cons-area cons-area/report/loop<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdaeefd0" class="outline-3">
<h3 id="orgdaeefd0">sweep-cons-area</h3>
<div class="outline-text-3" id="text-orgdaeefd0">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">sweep-cons-area/loop</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons-area-top eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span>  swap set
  cons-size add
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">sweep-cons-area</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-area<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  cons-area sweep-cons-area/loop<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7afacf7" class="outline-3">
<h3 id="org7afacf7">mark-cons-area</h3>
<div class="outline-text-3" id="text-org7afacf7">
<ul class="org-ul">
<li><p>root from</p><p><ul class="org-ul"></p><p><li><p>stack</p></li></p><p><li><p>defvar</p></li></ul></p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">mark-cons</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-area<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons? not <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup current-mark swap set
  dup car mark-cons
  cdr <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">mark-cons-area/defvar-record</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> defvar-record <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-area<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup get <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup get mark-cons
  cell-size add
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">mark-cons-area/argument-stack</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> stack <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-area<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup stack-base eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  cell-size sub
  dup get mark-cons
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">mark-cons-area</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>cons-area<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> current-mark max-mark eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      sweep-cons-area
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> current-mark<span style="color: #696969;">)</span> set<span style="color: #696969;">)</span>
  current-mark <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> current-mark<span style="color: #696969;">)</span> set
  defvar-record mark-cons-area/defvar-record
  stack-pointer
  mark-cons-area/argument-stack<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf768499" class="outline-3">
<h3 id="orgf768499">cons</h3>
<div class="outline-text-3" id="text-orgf768499">
<ul class="org-ul">
<li><p><p></p><p>cons</p><p></p></p><p><table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides"></p><p></p><p></p><p><colgroup></p><p><col  class="org-left" /></p><p></colgroup></p><p><tbody></p><p><tr></p><p><td class="org-left">mark</td></p><p></tr></p><p></p><p><tr></p><p><td class="org-left">car</td></p><p></tr></p><p></p><p><tr></p><p><td class="org-left">cdr</td></p><p></tr></p><p></tbody></p><p></table></p></li></ul>

<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">new/cons</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cons<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> cons-pointer cons-area-top eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      mark-cons-area
      cons-pointer/init
      cons-pointer/next-free
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> cons-pointer cons-area-top eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
          <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"fatal error : cons-area is full"</span><span style="color: #696969;">)</span> string/print
          newline bye<span style="color: #696969;">)</span>
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> cons-pointer get current-mark eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      cons-pointer/next <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  cons-pointer
  cons-pointer/next <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">set-car</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cell cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cons<span style="color: #696969;">)</span>
  tuck
  cell-size add
  set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">set-cdr</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cell cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cons<span style="color: #696969;">)</span>
  tuck
  cell-size add
  cell-size add
  set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">car</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cell<span style="color: #696969;">)</span>
  cell-size add
  get<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cdr</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cell<span style="color: #696969;">)</span>
  cell-size add
  cell-size add
  get<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">cons</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cdr-cell car-cell <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> cons<span style="color: #696969;">)</span>
  new/cons set-car set-cdr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org1be8a45" class="outline-3">
<h3 id="org1be8a45"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-org1be8a45">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span>
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> cons
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> cons
        dup car dot
        dup cdr car dot
        dup cdr cdr dot

        dup cons? dot
        dup cdr cons? dot
        dup car cons? dot
        dup cdr car cons? dot
        dup cdr cdr cons? dot
        dot

        current-mark
        dot<span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> newline
        new/cons dot
        new/cons dot
        new/cons dot
        new/cons dot
        new/cons dot
        current-mark dot
        newline
        cons-area/report
        newline<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org3aed435" class="outline-3">
<h3 id="org3aed435">list</h3>
<div class="outline-text-3" id="text-org3aed435">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>a <span style="color: #B380A8;">{</span>b c<span style="color: #B380A8;">}</span> d<span style="color: #B380A8;">}</span>
   null
   a cons
     null
     b cons
     c cons
   cons
   d cons<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">list/one</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>compile<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  read/jo
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup flower-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      drop null here
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">recur</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> cons<span style="color: #696969;">)</span> here
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup flower-ket eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup round-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      drop read/jo key-jo/apply
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> cons<span style="color: #696969;">)</span> here
      <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> instruction/lit<span style="color: #696969;">)</span> here
        here
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> cons<span style="color: #696969;">)</span> here
        <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">list</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>compile<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  read/jo
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup round-ket eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup flower-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span>
      drop null here
      list/one <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> drop <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org6118ba2" class="outline-3">
<h3 id="org6118ba2"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-org6118ba2">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span>a <span style="color: #B380A8;">{</span>b c<span style="color: #B380A8;">}</span> d<span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     dup car jo-&gt;string string/print
     dup cdr car car jo-&gt;string string/print
     dup cdr car cdr car jo-&gt;string string/print
     dup cdr car cdr cdr jo-&gt;string string/print
     dup cdr cdr car jo-&gt;string string/print
     dup cdr cdr cdr jo-&gt;string string/print
     drop<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">do</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1 2<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     dup car dot
     dup cdr car car dot
     dup cdr car cdr car dot
     dup cdr car cdr cdr dot
     dup cdr cdr car dot
     dup cdr cdr cdr dot
     drop<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org979e98c" class="outline-3">
<h3 id="org979e98c">int-list/print</h3>
<div class="outline-text-3" id="text-org979e98c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">declare</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span>-list/print <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">int-list/print/rest</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup cdr int-list/print/rest
  car
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> int-list/print <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> dot <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">int-list/print</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"{ "</span><span style="color: #696969;">)</span> string/print
  int-list/print/rest
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"} "</span><span style="color: #696969;">)</span> string/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orge234a86" class="outline-3">
<h3 id="orge234a86"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-orge234a86">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">do</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1 2<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     int-list/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org4a616c2" class="outline-3">
<h3 id="org4a616c2">jo/map &amp; jo/itr</h3>
<div class="outline-text-3" id="text-org4a616c2">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">jo/map</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>... a<span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span>a <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> b<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #B380A8;">{</span>... b<span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> over null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  over car over jo/apply
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2 1<span style="color: #696969;">)</span> xy-swap
  swap cdr swap <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">recur</span><span style="color: #696969;">)</span>
  swap cons<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">jo/itr</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>... a<span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span>a <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> over null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  over car over jo/apply
  swap cdr swap <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgfe26349" class="outline-3">
<h3 id="orgfe26349"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-orgfe26349">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">add1</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> int <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> int<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> add1<span style="color: #696969;">)</span> jo/apply
     dot<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2 1<span style="color: #696969;">)</span> xy-swap dot dot dot dot<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> add1<span style="color: #696969;">)</span> jo/map
     int-list/print<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> dot<span style="color: #696969;">)</span> jo/itr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org2bd218c" class="outline-3">
<h3 id="org2bd218c">map</h3>
<div class="outline-text-3" id="text-org2bd218c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">map</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>... a<span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span>a <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> b<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #B380A8;">{</span>... b<span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> over null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  over car over apply
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2 1<span style="color: #696969;">)</span> xy-swap
  swap cdr swap <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">recur</span><span style="color: #696969;">)</span>
  swap cons<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">itr</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>... a<span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span>a <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> over null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  over car over apply
  swap cdr swap <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org21fec27" class="outline-3">
<h3 id="org21fec27"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-org21fec27">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span> map
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span> map
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span> map
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span> map
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> add<span style="color: #696969;">)</span> map
     int-list/print<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jojo</span> dup dot dot<span style="color: #696969;">)</span> itr<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org182ccb7" class="outline-3">
<h3 id="org182ccb7">list/ref</h3>
<div class="outline-text-3" id="text-org182ccb7">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">list/ref</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #B380A8;">{</span>... a<span style="color: #B380A8;">}</span> int <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> a<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 0<span style="color: #696969;">)</span> lteq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop car <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> swap cdr swap <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> sub <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">)))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgf293b99" class="outline-3">
<h3 id="orgf293b99"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-orgf293b99">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 2<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 3<span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 4<span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1<span style="color: #696969;">)</span> list/ref dot<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbfc500c" class="outline-3">
<h3 id="orgbfc500c">jo-list/print</h3>
<div class="outline-text-3" id="text-orgbfc500c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">declare</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span>-list/print <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">jo/dot</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> jo <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  jo-&gt;string string/print
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">" "</span><span style="color: #696969;">)</span> string/print<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">jo-list/print/rest</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup cdr jo-list/print/rest
  car
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> jo-list/print <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> jo/dot <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">jo-list/print</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"{ "</span><span style="color: #696969;">)</span> string/print
  jo-list/print/rest
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"} "</span><span style="color: #696969;">)</span> string/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdd5cdd1" class="outline-3">
<h3 id="orgdd5cdd1"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-orgdd5cdd1">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span>a <span style="color: #B380A8;">{</span>b c<span style="color: #B380A8;">}</span> d<span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     jo-list/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgec47731" class="outline-3">
<h3 id="orgec47731">string-list/print</h3>
<div class="outline-text-3" id="text-orgec47731">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">declare</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span>-list/print <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">string/dot</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> string <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  double-quote jo-&gt;string string/print
  string/print
  double-quote jo-&gt;string string/print
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">" "</span><span style="color: #696969;">)</span> string/print<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">string-list/print/rest</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup null eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  dup cdr string-list/print/rest
  car
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup cons? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> string-list/print <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">else</span> string/dot <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">string-list/print</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> cons <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"{ "</span><span style="color: #696969;">)</span> string/print
  string-list/print/rest
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"} "</span><span style="color: #696969;">)</span> string/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgd556a11" class="outline-3">
<h3 id="orgd556a11"><span class="done test">test</span> </h3>
<div class="outline-text-3" id="text-orgd556a11">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">list</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"111"</span><span style="color: #696969;">)</span> <span style="color: #B380A8;">{</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"222"</span><span style="color: #696969;">)</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"333"</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"444"</span><span style="color: #696969;">)</span><span style="color: #B380A8;">}</span><span style="color: #696969;">)</span>
     string-list/print<span style="color: #696969;">)</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-orgff78e4c" class="outline-2">
<h2 id="orgff78e4c">case</h2>
<div class="outline-text-2" id="text-orgff78e4c">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">compile-jojo</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>compile<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">")"</span><span style="color: #696969;">)</span> string-&gt;jo compile-jojo/until-meet-jo<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> case-stack <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">int</span> 1024<span style="color: #696969;">)</span> cell-size mul allocate<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defvar</span> case-stack-pointer case-stack<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">case-stack-pop</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> stack/addr<span style="color: #696969;">)</span>
  case-stack-pointer cell-size sub
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> case-stack-pointer<span style="color: #696969;">)</span> set
  case-stack-pointer get<span style="color: #696969;">)</span>
<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">case-stack-push</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> stack/addr <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span>
  case-stack-pointer set
  case-stack-pointer cell-size add
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">var</span> case-stack-pointer<span style="color: #696969;">)</span> set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">case/one</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>compile<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span><span style="color: #696969;">)</span> compile-jojo/until-meet-jo
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> over<span style="color: #696969;">)</span> here
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> eq?<span style="color: #696969;">)</span> here
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> instruction/lit<span style="color: #696969;">)</span> here
  compiling-stack/tos compiling-stack/inc
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> jump-if-false<span style="color: #696969;">)</span> here
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> drop<span style="color: #696969;">)</span> here
  square-ket compile-jojo/until-meet-jo
  compiling-stack/tos swap set<span style="color: #696969;">)</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">defun</span> <span style="color: #a6e22e;">case</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #797979;">[</span>io<span style="color: #797979;">]</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #797979;">[</span>compile<span style="color: #797979;">]</span><span style="color: #696969;">)</span>
  read/jo
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup round-ket eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop <span style="color: #66d9ef; font-weight: bold;">end</span><span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup round-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop read/jo key-jo/apply <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">if</span> dup square-bar eq? <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> drop case/one <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>
  here <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">loop</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> a<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span>
    <span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> a<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"a"</span><span style="color: #696969;">)</span> string/print newline<span style="color: #797979;">]</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> comment<span style="color: #696969;">)</span>
    <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"between a &amp; b"</span><span style="color: #696969;">)</span> string/print newline
    <span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> b<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"b"</span><span style="color: #696969;">)</span> string/print newline<span style="color: #797979;">]</span><span style="color: #696969;">))</span>

<span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> b<span style="color: #696969;">)</span>
  <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">case</span>
    <span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> a<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"a"</span><span style="color: #696969;">)</span> string/print newline<span style="color: #797979;">]</span>
    <span style="color: #797979;">[</span><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">jo</span> b<span style="color: #696969;">)</span> <span style="color: #66d9ef; font-weight: bold;">-&gt;</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">string</span> <span style="color: #e6db74;">"b"</span><span style="color: #696969;">)</span> string/print newline<span style="color: #797979;">]</span><span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org7ae8322" class="outline-2">
<h2 id="org7ae8322">report</h2>
<div class="outline-text-2" id="text-org7ae8322">
<div class="org-src-container">

<pre class="src src-jojo"><span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">:</span> <span style="color: #696969;">(</span><span style="color: #f92672; font-weight: bold;">run</span> defprim/report
        defun/report
        defvar/report<span style="color: #696969;">))</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
涕执我乎垂丧兮 懼余生之茫苦
</div>
</body>
</html>
